import*as e from"react";import t,{useState as n,useRef as r,useEffect as o,isValidElement as i,useCallback as a}from"react";import{storybookArgTypes as l,storybookExcludedControlParams as c}from"@lg-tools/storybook-utils";import s,{Size as p}from"@leafygreen-ui/button";import{css as u,cx as f}from"@leafygreen-ui/emotion";import d,{isComponentGlyph as m}from"@leafygreen-ui/icon";import g,{Align as h,Justify as b,TestUtils as y}from"@leafygreen-ui/popover";import{fontFamilies as v,fontWeights as x,transitionDuration as j,BaseFontSize as w}from"@leafygreen-ui/tokens";import{useUpdatedBaseFontSize as E,bodyTypeScaleStyles as O,Subtitle as k,Body as S,InlineCode as C}from"@leafygreen-ui/typography";import{flushSync as P}from"react-dom";import M from"lodash/debounce";import N from"prop-types";import{useIdAllocator as T,useEscapeKey as F,useBackdropClick as I}from"@leafygreen-ui/hooks";import A,{useDarkMode as z}from"@leafygreen-ui/leafygreen-provider";import{transparentize as L}from"polished";import{Theme as R}from"@leafygreen-ui/lib";import{palette as B}from"@leafygreen-ui/palette";import H from"lodash/clamp";function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){J(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}function J(e,t,n){return(t=U(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Y(){return Y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Y.apply(this,arguments)}function Z(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function G(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t);else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return l}}(e,t)||q(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){if(e){if("string"==typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(e,t):void 0}}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $(t){return e.createElement("svg",Y({width:26,height:8,fill:"#001E2B",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 26 8"},t),e.createElement("path",{d:"M27 0H-1v1h.699a10 10 0 017.26 3.123l1.685 1.78a6 6 0 008.712 0l1.686-1.78A10 10 0 0126.302 1H27V0z"}))}var Q,W,_,ee,te,ne,re,oe,ie,ae,le,ce,se,pe=8,ue=26,fe=16,de=u(Q||(Q=G(["\n  margin: unset;\n  font-family: ",";\n  color: ",";\n  font-weight: ",";\n  width: 100%;\n  overflow-wrap: anywhere;\n"])),v.default,B.gray.light1,x.regular),me=u(W||(W=G(["\n  display: flex;\n  align-items: center;\n  border-radius: ","px;\n  padding: 12px ","px;\n  box-shadow: 0px 2px 4px -1px ",";\n  cursor: default;\n  width: fit-content;\n  max-width: 256px;\n"])),fe,fe,L(.85,B.black)),ge=u(_||(_=G(["\n  position: relative;\n"]))),he=J(J({},R.Light,{tooltip:u(ee||(ee=G(["\n      background-color: ",";\n      color: ",";\n    "])),B.black,B.gray.light1),children:u(te||(te=G(["\n      color: inherit;\n    "]))),notchFill:B.black}),R.Dark,{tooltip:u(ne||(ne=G(["\n      background-color: ",";\n      color: ",";\n    "])),B.gray.light2,B.black),children:u(re||(re=G(["\n      color: inherit;\n    "]))),notchFill:B.gray.light2}),be=ue+2*fe,ye=u(oe||(oe=G(["\n  min-height: ","px;\n"])),be),ve=u(ie||(ie=G(["\n  transition-delay: ","ms;\n"])),j.slowest),xe={Hover:"hover",Click:"click"},je={Top:h.Top,Bottom:h.Bottom,Left:h.Left,Right:h.Right};var we=["initialOpen","open","setOpen","darkMode","baseFontSize","triggerEvent","enabled","align","justify","spacing","usePortal","onClose","id","shouldClose","portalClassName","portalContainer","portalRef","scrollContainer","popoverZIndex","refEl","className","children","trigger"],Ee=function(e){e.stopPropagation()};function Oe(e){var l,c=e.initialOpen,s=void 0!==c&&c,p=e.open,d=e.setOpen,h=e.darkMode,y=e.baseFontSize,v=e.triggerEvent,x=void 0===v?xe.Hover:v,j=e.enabled,w=void 0===j||j,k=e.align,S=void 0===k?"top":k,C=e.justify,N=void 0===C?"start":C,L=e.spacing,R=void 0===L?12:L,B=e.usePortal,X=void 0===B||B,U=e.onClose,q=void 0===U?function(){}:U,K=e.id,Q=e.shouldClose,W=e.portalClassName,_=e.portalContainer,ee=e.portalRef,te=e.scrollContainer,ne=e.popoverZIndex,re=e.refEl,oe=e.className,ie=e.children,be=e.trigger,Oe=Z(e,we),ke="boolean"==typeof p,Se=V(n(s),2),Ce=Se[0],Pe=Se[1],Me=E(y),Ne=ke?p:Ce,Te=ke&&d?d:Pe,Fe=r(null),Ie=null!=K?K:null===(l=Fe.current)||void 0===l?void 0:l.id,Ae=T({prefix:"tooltip",id:Ie}),ze=z(h),Le=ze.darkMode,Re=ze.theme;o((function(){be&&i(be)&&m(be)&&console.warn("Using a LeafyGreenUI Icon or Glyph component as a trigger will not render a Tooltip, as these components do not render their children. To use, please wrap your trigger element in another HTML tag.")}),[be]);var Be=a((function(){("function"!=typeof Q||Q())&&(q(),Te(!1))}),[Te,Q,q]),He=a((function(e,t){return e===xe.Hover?{onMouseEnter:M((function(e){n("onMouseEnter",e),P((function(){Te(!0)}))}),35),onMouseLeave:M((function(e){n("onMouseLeave",e),Be()}),35),onFocus:function(e){n("onFocus",e),Te(!0)},onBlur:function(e){n("onBlur",e),Be()}}:{onClick:function(e){e.target!==Fe.current&&(n("onClick",e),Te((function(e){return!e})))}};function n(e,n){t&&t[e]&&"function"==typeof t[e]&&t[e](n)}}),[Be,Te,Fe]);F(Be,{enabled:Ne}),I(Be,[Fe],Ne&&"click"===x);var Xe=D({refEl:re,popoverZIndex:ne},X?{spacing:R,usePortal:X,portalClassName:W,portalContainer:_,portalRef:ee,scrollContainer:te}:{spacing:R,usePortal:X}),De=w&&Ne,Ue=["left","right"].includes(S),Je=t.createElement(g,Y({key:"tooltip",active:De,align:S,justify:N,adjustOnMutation:!0,onClick:Ee,className:f(ve,J({},u(se||(se=G(["\n          // Try to fit all the content on one line (until it hits max-width)\n          // Overrides default behavior, which is to set width to size of the trigger.\n          // Except when justify is set to fit because the width should be the size of the trigger.\n          // Another exception is when justify is set to fit and the alignment is either left or right. In this case only the height should be the size of the trigger so we still want the width to fit the max content.\n          width: max-content;\n        "]))),N!==b.Fit||N===b.Fit&&(S===je.Left||S===je.Right)))},Xe),(function(e){var n=function(e){var t=e.align,n=e.justify,r=e.triggerRect;if(!t||!n||!r)return{notchContainer:"",notch:"",tooltip:""};var o,i,a=ue,l=-(a-pe)/2,c={},s={},p=fe,f=2*p,d=0,m="";switch(t){case"top":case"bottom":switch(f=3*p,o=r.width/2-a/2,d=H(o,p,f),i=o<=p,c.left="0px",c.right="0px","top"===t?(s.top="calc(100% - 1px)",c.top="".concat(l,"px")):(s.bottom="calc(100% - 1px)",c.bottom="".concat(l,"px"),c.transform="rotate(180deg)"),n){case b.Start:s.left="".concat(d,"px"),i&&(m="translateX(-".concat(p-o,"px)"));break;case b.Middle:s.left="0px",s.right="0px";break;case b.Fit:s.left="".concat(d,"px"),i&&(m="translateX(-".concat(p-o,"px)"));break;case b.End:s.right="".concat(d,"px"),i&&(m="translateX(".concat(p-o,"px)"))}break;case"left":case"right":switch(f=2*p,o=r.height/2-a/2,d=H(o,p,f),i=o<=p,c.top="0px",c.bottom="0px","left"===t?(s.left="calc(100% - 1px)",c.left="".concat(l,"px"),c.transform="rotate(-90deg)"):(s.right="calc(100% - 1px)",c.right="".concat(l,"px"),c.transform="rotate(90deg)"),n){case b.Start:s.top="".concat(d,"px"),i&&(m="translateY(-".concat(p-o,"px)"));break;case b.Middle:s.top="0px",s.bottom="0px";break;case b.Fit:s.top="".concat(d,"px"),i&&(m="translateY(-".concat(p-o,"px)"));break;case b.End:s.bottom="".concat(d,"px"),i&&(m="translateY(".concat(p-o,"px)"))}}return{notchContainer:u(ae||(ae=G(["\n      position: absolute;\n      width: ","px;\n      height: ","px;\n      overflow: hidden;\n      margin: auto;\n      pointer-events: none;\n      ",";\n    "])),a,a,u(s)),notch:u(le||(le=G(["\n      ",";\n      position: absolute;\n      width: ","px;\n      height: ","px; // Keep it square. Rotating is simpler\n      margin: 0;\n    "])),u(c),ue,ue),tooltip:u(ce||(ce=G(["\n      min-width: ","px;\n      transform: ",";\n    "])),2*d+a,m)}}({align:e.align,justify:e.justify,triggerRect:e.referenceElPos}),r=n.notchContainer,o=n.notch,i=n.tooltip;return t.createElement(A,{darkMode:!Le},t.createElement("div",Y({role:"tooltip"},Oe,{id:Ae,className:f(me,i,he[Re].tooltip,J({},ye,Ue),oe),ref:Fe}),t.createElement("div",{className:f(de,O[Me],he[Re].children)},ie),t.createElement("div",{className:r},t.createElement($,{className:f(o),fill:he[Re].notchFill}))))}));return be?"function"==typeof be?be(D(D({},He(x)),{},{className:ge,"aria-describedby":De?Ae:void 0,children:Je})):t.cloneElement(be,D(D({},He(x,be.props)),{},{"aria-describedby":De?Ae:void 0,children:t.createElement(t.Fragment,null,be.props.children,Je),className:f(ge,be.props.className)})):Je}Oe.displayName="Tooltip",Oe.propTypes={children:N.node,className:N.string,align:N.oneOf(Object.values(je)),justify:N.oneOf(Object.values(b)),trigger:N.oneOfType([N.node,N.func]),triggerEvent:N.oneOf(Object.values(xe)),darkMode:N.bool,enabled:N.bool,open:N.bool,setOpen:N.func,id:N.string,shouldClose:N.func,usePortal:N.bool,portalClassName:N.string,portalRef:N.shape({current:"undefined"!=typeof window?N.instanceOf(Element):N.any})};var ke,Se,Ce,Pe,Me,Ne,Te,Fe,Ie,Ae,ze,Le,Re=["darkMode"],Be=["darkMode"],He=["refButtonPosition","buttonText","justify","align"],Xe=y.getAlign,De=y.getJustify,Ue="5hhs8d83jj2992h88d9s49ns94jsjsj9456j9djdf95hhs8d83jj2992h88d9s49ns94jsjsj9456j9djdf9",Je={title:"Components/Tooltip",component:Oe,parameters:{default:"LiveExample",controls:{exclude:[].concat((Le=c,function(e){if(Array.isArray(e))return K(e)}(Le)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(Le)||q(Le)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),["trigger"])},chromatic:{disableSnapshot:!0,delay:j.slowest},generate:{storyNames:["ShortString","LongString","JSXChildren"],combineArgs:{darkMode:[!1,!0],align:Object.values(je),justify:Object.values(b),baseFontSize:Object.values(w)},excludeCombinations:[{justify:b.Fit,children:Ue},{justify:b.Fit,align:[je.Left,je.Right]}],args:{open:!0},decorator:function(e,n){return t.createElement("div",{className:u(ke||(ke=G(["\n            width: 256px;\n            height: 100px;\n            display: flex;\n            align-items: ",";\n            justify-content: ",";\n          "])),Xe(null==n?void 0:n.args.align,null==n?void 0:n.args.justify),De(null==n?void 0:n.args.align,null==n?void 0:n.args.justify))},t.createElement(e,{trigger:t.createElement(s,{darkMode:null==n?void 0:n.args.darkMode,size:"xsmall"},"trigger")}))}}},args:{enabled:!0,usePortal:!0,trigger:t.createElement(s,{size:p.XSmall},"Trigger")},argTypes:{open:{control:"boolean"},darkMode:l.darkMode,children:l.children,baseFontSize:{control:"radio",options:Object.values(w)}}},Ye=function(e){var n=e.darkMode,r=Z(e,Re);return t.createElement("div",{className:u(Se||(Se=G(["\n      padding: 100px;\n    "])))},t.createElement(Oe,Y({darkMode:n},r)))};Ye.args={children:"I am a tooltip!"},Ye.argTypes={open:{control:"none"}},Ye.parameters={chromatic:{disableSnapshot:!0}};var Ze=function(e){var r=V(n(!0),2),o=r[0],i=r[1];return t.createElement(Oe,Y({},e,{open:o,setOpen:i}))};Ze.parameters={chromatic:{disableSnapshot:!0}};var Ge=function(e){return t.createElement("div",{className:u(Ce||(Ce=G(["\n        padding: 100px;\n      "])))},t.createElement(Oe,Y({initialOpen:!0},e)))};Ge.args={enabled:!0,usePortal:!0,trigger:t.createElement(s,{size:p.XSmall},"Trigger"),children:"I am a tooltip!"},Ge.parameters={chromatic:{disableSnapshot:!0}};var Ve=Ye.bind({});Ve.args={children:t.createElement(t.Fragment,null,t.createElement(k,null,"Example"),t.createElement(S,null,"Use Tooltip in your codebase:"),t.createElement(C,null,"@leafygreen-ui/tooltip"))},Ve.parameters={chromatic:{disableSnapshot:!0}};var qe=function(e){var n=e.darkMode,r=Z(e,Be);return t.createElement("div",{className:u(Pe||(Pe=G(["\n        display: grid;\n        grid-template-columns: repeat(4, 64px);\n        grid-template-rows: repeat(4, 64px);\n        width: 100%;\n        gap: 64px;\n        align-items: center;\n        justify-items: center;\n        justify-content: center;\n        padding: 96px;\n      "])))},Object.values(je).map((function(e){return Object.values(b).map((function(o){return t.createElement(Oe,Y({},r,{key:e+o,darkMode:n,align:e,justify:o,triggerEvent:"click"}),"Align ",e,", Justify ",o,".")}))})))};qe.parameters={chromatic:{disableSnapshot:!0}};var Ke=u(Me||(Me=G(["\n  width: 600px;\n  height: 80vh;\n  background-color: #e8edeb;\n  overflow: scroll;\n  position: relative;\n"]))),$e=u(Ne||(Ne=G(["\n  position: relative;\n  height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),Qe={centered:u(Te||(Te=G(["\n    position: relative;\n  "]))),top:u(Fe||(Fe=G(["\n    top: 20px;\n    position: absolute;\n  "]))),right:u(Ie||(Ie=G(["\n    right: 20px;\n    position: absolute;\n  "]))),bottom:u(Ae||(Ae=G(["\n    bottom: 20px;\n    position: absolute;\n  "]))),left:u(ze||(ze=G(["\n    left: 20px;\n    position: absolute;\n  "])))},We=function(e){var r=e.refButtonPosition;e.buttonText;var o=e.justify,i=e.align,a=Z(e,He),l=V(n(null),2),c=l[0],s=l[1],p=Qe[r];return t.createElement("div",{className:Ke},t.createElement("div",{className:$e,ref:function(e){return s(e)}},t.createElement("div",{className:p},t.createElement(Oe,Y({trigger:t.createElement("span",null,t.createElement(d,{glyph:"Cloud"})),portalContainer:c,scrollContainer:c,triggerEvent:"click",justify:o,align:i},a),"I am a Tooltip! Lorem ipsum dolor sit amet, consectetur adipiscing elit"))))};We.parameters={chromatic:{disableSnapshot:!0}},We.args={usePortal:!0},We.argTypes={refButtonPosition:{options:["centered","top","right","bottom","left"],control:{type:"select"},description:"Storybook only prop. Used to change position of the reference button",defaultValue:"centered"},usePortal:{control:"none"},portalClassName:{control:"none"},refEl:{control:"none"},className:{control:"none"},active:{control:"none"},trigger:{control:"none"},triggerEvent:{control:"none"},enabled:{control:"none"},open:{control:"none"},setOpen:{control:"none"},children:{control:"none"},darkMode:{control:"none"}};var _e=function(){return t.createElement(t.Fragment,null)};_e.args={children:"I am a tooltip!"};var et=function(){return t.createElement(t.Fragment,null)};et.args={children:Ue},et.parameters={generate:{excludeCombinations:[{justify:b.Fit}]}};var tt=function(){return t.createElement(t.Fragment,null)};tt.args={children:t.createElement(C,null,"@leafygreen-ui/tooltip")};export{qe as AlignmentTest,Ze as ControlledWithState,Ge as InitialOpen,tt as JSXChildren,Ye as LiveExample,et as LongString,We as ScrollableContainer,_e as ShortString,Ve as WithLeafyGreenChildren,Je as default};
