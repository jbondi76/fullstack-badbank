import n,{useRef as e,useEffect as r,forwardRef as o,useState as t,useMemo as a,useCallback as i,useContext as l}from"react";import c from"lodash/isNull";import d from"lodash/once";import s from"prop-types";import{css as u,cx as p}from"@leafygreen-ui/emotion";import{useDynamicRefs as f,useIdAllocator as g}from"@leafygreen-ui/hooks";import{useUsingKeyboardContext as h,useDarkMode as v,useBaseFontSize as m}from"@leafygreen-ui/leafygreen-provider";import{Theme as b,isComponentType as x}from"@leafygreen-ui/lib";import{Overline as y}from"@leafygreen-ui/typography";import{transparentize as w}from"polished";import{palette as k}from"@leafygreen-ui/palette";import{fontFamilies as C,transitionDuration as z,fontWeights as O,focusRing as S}from"@leafygreen-ui/tokens";import j from"@leafygreen-ui/box";import{isComponentGlyph as E}from"@leafygreen-ui/icon";function N(n){var e=function(n,e){if("object"!=typeof n||!n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var o=r.call(n,e);if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n,"string");return"symbol"==typeof e?e:e+""}function _(n,e,r){return(e=N(e))in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}function D(){return D=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},D.apply(this,arguments)}function A(n,e){if(null==n)return{};var r,o,t=function(n,e){if(null==n)return{};var r,o,t={},a=Object.keys(n);for(o=0;o<a.length;o++)r=a[o],e.indexOf(r)>=0||(t[r]=n[r]);return t}(n,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(o=0;o<a.length;o++)r=a[o],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function I(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function L(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var r=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=r){var o,t,a,i,l=[],c=!0,d=!1;try{if(a=(r=r.call(n)).next,0===e);else for(;!(c=(o=a.call(r)).done)&&(l.push(o.value),l.length!==e);c=!0);}catch(n){d=!0,t=n}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw t}}return l}}(n,e)||function(n,e){if(!n)return;if("string"==typeof n)return P(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);"Object"===r&&n.constructor&&(r=n.constructor.name);if("Map"===r||"Set"===r)return Array.from(n);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P(n,e)}(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(n,e){e>n.length&&(e=n.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=n[r];return o}var F,M,H,T,X,q,K,V,G,R,U,$,B="small",J={XSmall:"xsmall",Default:"default",Large:"large"},Q=n.createContext({size:J.Default,theme:b.Light,name:"",followFocus:!0});var W,Y,Z=u(F||(F=I(["\n  display: flex;\n  gap: 8px;\n  align-items: center;\n  z-index: 0;\n  font-family: ",";\n"])),C.default),nn=u(M||(M=I(["\n  white-space: nowrap;\n"]))),en=_(_({},b.Light,u(H||(H=I(["\n    color: ",";\n  "])),k.gray.dark1)),b.Dark,u(T||(T=I(["\n    color: ",";\n  "])),k.gray.light1)),rn=_(_(_({},J.XSmall,u(X||(X=I(["\n    --segment-gap: 1px; // space between segments\n    --wrapper-padding: 0px;\n    --indicator-height: 100%;\n    --outer-radius: 6px;\n    --indicator-radius: 6px;\n  "])))),J.Default,u(q||(q=I(["\n    --segment-gap: 5px; // space between segments\n    --indicator-height: calc(100% - 2 * var(--wrapper-padding));\n    --wrapper-padding: 3px;\n    --outer-radius: 8px;\n    --indicator-radius: 6px;\n  "])))),J.Large,u(K||(K=I(["\n    --segment-gap: 5px; // space between segments\n    --indicator-height: calc(100% - 2 * var(--wrapper-padding));\n    --outer-radius: 8px;\n    --wrapper-padding: 3px;\n    --indicator-radius: 6px;\n  "])))),on=_(_({},b.Light,u(V||(V=I(["\n    --background-color: ",";\n    --inner-shadow: 0px 1px 2px "," inset;\n    --outer-shadow: 0px 1px 1px ",";\n    --hover-background-color: ",";\n    --indicator-background-color: ",";\n    --indicator-border-color: ",";\n  "])),k.gray.light3,w(.7,k.black),k.gray.light2,k.white,k.black,k.black)),b.Dark,u(G||(G=I(["\n    --background-color: ",";\n    --border-color: rgba(255, 255, 255, 0);\n    --inner-shadow: 0px 0px 0px 1px "," inset;\n    --outer-shadow: 0px 0px 0px 0px rgba(255, 255, 255, 0);\n    --hover-background-color: ",";\n    --indicator-background-color: ",";\n    --indicator-border-color: ",";\n  "])),k.gray.dark4,k.gray.dark1,k.gray.dark3,k.gray.light2,k.gray.light2)),tn=function(n){var e=n.theme,r=n.size;return p(rn[void 0===r?"default":r],on[e],u(R||(R=I(["\n      position: relative;\n      display: grid;\n      grid-auto-flow: column;\n      grid-auto-columns: minmax(\n        0,\n        1fr\n      ); // allows the grid tracks to be as small as 0 but as large as 1fr, creating columns that will stay equal\n      gap: var(--segment-gap);\n      align-items: center;\n      padding: var(--wrapper-padding);\n      border-radius: var(--outer-radius);\n      background-color: var(--background-color);\n\n      &:focus {\n        outline: none;\n      }\n\n      // Frame shadow\n      &:after {\n        content: '';\n        position: absolute;\n        width: 100%;\n        height: 100%;\n        border-radius: inherit;\n        box-shadow: var(--inner-shadow), var(--outer-shadow);\n        z-index: 1;\n        pointer-events: none;\n      }\n    "]))))},an=u(U||(U=I(["\n  position: absolute;\n  width: 100%;\n  height: var(--indicator-height);\n  z-index: 2;\n  border-radius: var(--indicator-radius);\n  background-color: var(--indicator-background-color);\n  transition: transform ","ms ease-in-out;\n"])),z.default),ln=u($||($=I(["\n  position: absolute;\n  height: var(--indicator-height);\n  width: 100%;\n  border-radius: var(--indicator-radius);\n  background-color: var(--hover-background-color);\n  z-index: 0;\n  opacity: 0;\n  transition: opacity 100ms ease-in-out;\n"]))),cn=["children","name","size","darkMode","defaultValue","value","onChange","className","label","followFocus","aria-controls"],dn=o((function(o,l){var d,s,m=o.children,b=o.name,w=o.size,k=void 0===w?J.Default:w,C=o.darkMode,z=o.defaultValue,O=o.value,S=o.onChange,j=o.className,E=o.label,N=o.followFocus,_=void 0===N||N,P=o["aria-controls"],F=A(o,cn),M=h().usingKeyboard,H=e(null),T=L(t(!1),2),X=T[0],q=T[1],K=v(C).theme,V=f({prefix:"option"}),G=g({prefix:"segmented-control",id:b}),R=a((function(){return null!=O}),[O]),U=L(t(null!=z?z:O),2),$=U[0],rn=U[1],on=L(t(null!=z?z:O),2),dn=on[0],sn=on[1];d=function(){var e=n.Children.toArray(m)[0];!$&&x(e,"SegmentedControlOption")&&(rn(e.props.value),sn(e.props.value))},s=e(!1),r((function(){s.current||(s.current=!0,d())}),[d]);var un=i((function(){var n;null!==(n=H.current)&&void 0!==n&&n.contains(document.activeElement)?q(!0):q(!1)}),[]);r((function(){return document.addEventListener("focusin",un),function(){document.removeEventListener("focusin",un)}}),[un]),r((function(){R&&rn(O)}),[O,R]);var pn=i((function(n){$!==n&&(rn(n),null==S||S(n))}),[$,S]),fn=a((function(){return n.Children.map(m,(function(e,r){var o,t;if(null==e)return e;if(!x(e,"SegmentedControlOption"))return zn("Error in Segmented Control: ".concat(e," is not a SegmentedControlOption")),e;P||e.props["aria-controls"]||On("The property `aria-controls` is required on each Segmented Control option, or on the Segmented Control parent.");var a=null!==(o=e.props.id)&&void 0!==o?o:"".concat(G,"-").concat(r),i=R?e.props.value===O||!!e.props.checked:e.props.value===$,l=e.props.value===dn;return n.cloneElement(e,{_id:a,_checked:i,_focused:l,_index:r,"aria-controls":null!==(t=e.props["aria-controls"])&&void 0!==t?t:P,_onClick:pn,_onHover:function(n){mn(n?r:null)},ref:V("".concat(r)),isfocusInComponent:X})}))}),[m,R,O,$,dn,G,P,pn,V,X]),gn=a((function(){if(fn){var e,r=null===(e=n.Children.map(fn,(function(n){var e;return null==n||null===(e=n.props)||void 0===e?void 0:e._id})))||void 0===e?void 0:e.join(" ");return null!=r?r:""}return""}),[fn]),hn=L(t(null),2),vn=hn[0],mn=hn[1],bn=a((function(){return n.Children.toArray(fn).findIndex((function(n){return R?n.props.value===O:n.props.value===$}))}),[O,R,fn,$]),xn=a((function(){return n.Children.toArray(fn).findIndex((function(n){return n.props.value===dn}))}),[fn,dn]),yn=function(e){var r=n.Children.toArray(fn).filter((function(n){return!n.props.disabled})),o=r.length,t=r[e=e>=o?e%o:e<0?o+e:e].props.value;sn(t)};r((function(){M||sn($)}),[$,M]);var wn=i((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(c(e))return u(W||(W=I(["\n          width: 0;\n        "])));var r=1/n.Children.count(fn)*100,o=100*e;return u(Y||(Y=I(["\n        opacity: 1;\n        width: calc(","% - 2 * var(--wrapper-padding));\n        transform: translateX(\n          calc(","% + "," * var(--wrapper-padding))\n        );\n      "])),r,o,2*e+1)}),[fn]),kn=k===B?J.XSmall:k;return n.createElement(Q.Provider,{value:{size:kn,theme:K,name:G,followFocus:_}},n.createElement("div",D({ref:H,className:p(Z,j)},F),E&&n.createElement(y,{className:p(nn,en[K])},E),n.createElement("div",{role:"tablist","aria-label":G,"aria-owns":gn,className:p(tn({theme:K,size:kn})),ref:l,onKeyDownCapture:function(n){switch(n.stopPropagation(),n.key){case"ArrowRight":yn(xn+1);break;case"ArrowLeft":yn(xn-1)}}},fn,n.createElement("div",{className:p(an,wn(bn))}),n.createElement("div",{className:p(ln,wn(vn))}))))}));dn.displayName="SegmentedControl";var sn,un,pn,fn,gn,hn,vn,mn,bn,xn,yn,wn,kn,Cn,zn=d(console.error),On=d(console.warn);dn.propTypes={darkMode:s.bool,size:s.oneOf(Object.values(J)),onChange:s.func,defaultValue:s.string,value:s.string,label:s.node,name:s.string,followFocus:s.bool,className:s.string};var Sn=_(_({},b.Light,u(sn||(sn=I(["\n    --base-text-color: ",";\n    --base-background-color: rgba(255, 255, 255, 0);\n    --base-shadow-color: rgba(255, 255, 255, 0);\n    // Hover\n    --hover-text-color: ",";\n    // Selected\n    --active-text-color: ",";\n    // Disabled\n    --disabled-text-color: ",";\n    // Divider\n    --divider-background-color: ",";\n  "])),k.gray.dark1,k.gray.dark3,k.white,k.gray.light1,k.gray.light1)),b.Dark,u(un||(un=I(["\n    --base-text-color: ",";\n    --base-background-color: rgba(255, 255, 255, 0);\n    --base-shadow-color: rgba(255, 255, 255, 0);\n    // Hover\n    --hover-text-color: ",";\n    // Selected\n    --active-text-color: ",";\n    // Disabled\n    --disabled-text-color: ",";\n    // Divider\n    --divider-background-color: ",";\n  "])),k.gray.light1,k.gray.light2,k.black,k.gray.dark2,k.gray.dark2)),jn=_(_(_({},J.XSmall,u(pn||(pn=I(["\n    --font-size: 12px;\n    --line-height: 16px;\n    --padding-inline: 12px;\n    --text-transform: uppercase;\n    --font-weight: ",";\n    --divider-height: 12px;\n    --padding-block: 3px;\n  "])),O.bold)),J.Default,u(fn||(fn=I(["\n    --font-size: 13px;\n    --line-height: 24px;\n    --padding-inline: 12px; // left/right\n    --text-transform: none;\n    --font-weight: ",";\n    --divider-height: 18px;\n    --padding-block: 3px;\n  "])),O.medium)),J.Large,u(gn||(gn=I(["\n    --font-size: 16px;\n    --line-height: 28px;\n    --padding-inline: 12px;\n    --text-transform: none;\n    --font-weight: ",";\n    --divider-height: 20px;\n    --padding-block: 4px;\n  "])),O.medium)),En=function(n){var e=n.theme,r=n.size,o=void 0===r?"default":r,t=n.baseFontSize,a=void 0===t?14:t;return p(Sn[e],jn[o],u(hn||(hn=I(["\n      position: relative;\n      display: flex;\n      width: 100%;\n      align-items: center;\n      justify-content: center;\n      z-index: 3;\n\n      &:first-child,\n      &[data-lg-checked='true'],\n      &[data-lg-checked='true'] + [data-lg-checked='false'],\n      &:focus-within + :not(:focus-within) {\n        --divider-background-color: transparent;\n      }\n\n      /* \n      * Adds the divider line to unselected segments \n      */\n      &:before {\n        --divider-width: 1px;\n        content: '';\n        position: absolute;\n        height: var(--divider-height);\n        width: var(--divider-width);\n        left: calc(0px - (var(--segment-gap) + var(--divider-width)) / 2);\n        top: calc(\n          (\n              var(--line-height) + var(--padding-block) * 2 -\n                var(--divider-height)\n            ) / 2\n        );\n        transition: background-color ","ms ease-in-out;\n        background-color: var(--divider-background-color);\n      }\n    "])),z.default),_({},u(vn||(vn=I(["\n        --font-size: 16px;\n      "]))),"default"===o&&16===a))},Nn=u(mn||(mn=I(["\n  width: 100%;\n  height: 100%;\n  text-decoration: none;\n"]))),_n=u(bn||(bn=I(["\n  font-family: ",";\n  display: flex;\n  position: relative;\n  width: 100%;\n  height: 100%;\n  align-items: center;\n  justify-content: center;\n  padding: var(--padding-block) var(--padding-inline);\n  background-color: var(--base-background-color);\n  border-radius: var(--indicator-radius);\n  text-align: center;\n  font-size: var(--font-size);\n  line-height: var(--line-height);\n  text-transform: var(--text-transform, none);\n  font-weight: var(--font-weight);\n  color: var(--base-text-color);\n  box-shadow: 0px 1px 2px var(--base-shadow-color);\n  cursor: pointer;\n  transition: ","ms ease-in-out;\n  transition-property: color, box-shadow;\n  text-decoration: none;\n  outline: none;\n  border: none;\n\n  svg {\n    transition: color ","ms ease-in-out;\n  }\n\n  &:hover {\n    color: var(--hover-text-color);\n  }\n\n  &[aria-selected='true'] {\n    color: var(--active-text-color);\n  }\n\n  &:disabled {\n    color: var(--disabled-text-color);\n    cursor: not-allowed;\n  }\n\n  &[aria-selected='false']:not(:disabled):not(:hover) {\n    svg {\n      color: ",";\n    }\n  }\n"])),C.default,z.default,z.default,k.gray.base),Dn=u(xn||(xn=I(["\n  &[aria-selected='false']:not(:disabled):not(:hover) {\n    svg {\n      color: var(--base-text-color);\n    }\n  }\n"]))),An=_(_({},b.Light,u(yn||(yn=I(["\n    &:focus {\n      box-shadow: ",";\n    }\n  "])),S.light.default)),b.Dark,u(wn||(wn=I(["\n    &:focus {\n      box-shadow: ",";\n    }\n  "])),S.dark.default)),In=u(kn||(kn=I(["\n  min-height: var(--line-height);\n  gap: calc(var(--font-size) / 2);\n  display: flex;\n  align-items: center;\n  min-width: 0;\n\n  svg {\n    flex-shrink: 0;\n  }\n"]))),Ln=u(Cn||(Cn=I(["\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n"]))),Pn=["value","children","disabled","as","className","aria-controls","_id","_checked","_focused","_index","_onClick","_onHover","isfocusInComponent","glyph"],Fn=o((function(o,t){var a,i=o.value,c=o.children,d=o.disabled,s=void 0!==d&&d,u=o.as,f=o.className,g=o["aria-controls"],v=o._id,b=o._checked,x=o._focused;o._index;var y=o._onClick,w=o._onHover,k=o.isfocusInComponent,C=o.glyph,z=A(o,Pn),O=l(Q),S=O.size,N=O.theme,I=O.followFocus,L=h().usingKeyboard,P=m(),F=e(!1),M=e(null);r((function(){var n,e;F.current&&(L&&x&&k&&(null==M||null===(n=M.current)||void 0===n||n.focus(),I&&(null==M||null===(e=M.current)||void 0===e||e.click())));F.current=!0}),[x,I,L,k]),r((function(){C&&!E(C)&&console.warn("Please provide a LeafyGreen UI Icon or Glyph component.")}),[C]);var H=null!==(a=C&&!c)&&void 0!==a&&a;return n.createElement("div",{className:p(En({theme:N,size:S,baseFontSize:P}),f),ref:t,"data-lg-checked":b},n.createElement(j,D({as:u,tabIndex:-1,className:Nn},z),n.createElement("button",{role:"tab",id:v,tabIndex:x?0:-1,"aria-selected":b,"aria-controls":g,disabled:s,className:p(_n,_(_({},An[N],L),Dn,H)),ref:M,onClick:function(){null==y||y(i)},onMouseEnter:function(){null==w||w(!0)},onMouseLeave:function(){null==w||w(!1)},type:"button"},n.createElement("div",{className:In},C&&E(C)&&C,!H&&n.createElement("span",{className:Ln},c)))))}));Fn.displayName="SegmentedControlOption",Fn.propTypes={value:s.string.isRequired,className:s.string,disabled:s.bool,glyph:s.element};export{dn as SegmentedControl,Fn as SegmentedControlOption};
//# sourceMappingURL=index.js.map
