import e,{useState as t,useRef as n,useEffect as r}from"react";import{storybookArgTypes as o,storybookExcludedControlParams as a}from"@lg-tools/storybook-utils";import i from"@leafygreen-ui/button";import{css as l,cx as c}from"@leafygreen-ui/emotion";import{palette as s}from"@leafygreen-ui/palette";import u,{Align as p,Justify as m}from"@leafygreen-ui/popover";import{Body as f,Disclaimer as d}from"@leafygreen-ui/typography";import{flushSync as b}from"react-dom";import y from"prop-types";import{usePrefersReducedMotion as g}from"@leafygreen-ui/a11y";import{useIdAllocator as h,useIsomorphicLayoutEffect as v}from"@leafygreen-ui/hooks";import{useDarkMode as E}from"@leafygreen-ui/leafygreen-provider";import{transparentize as x}from"polished";import{Theme as O}from"@leafygreen-ui/lib";import C from"focus-trap-react";import k from"@leafygreen-ui/icon/dist/X";import S from"@leafygreen-ui/icon-button";import w from"@leafygreen-ui/tooltip";function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function T(e,t,n){return(t=j(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A(){return A=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},A.apply(this,arguments)}function P(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function B(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t);else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||D(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){if(e){if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?F(e,t):void 0}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var R,z,J,Z,L,G,H,q,V,Y,U,X,$,K,Q,W=l(R||(R=B(["\n  padding: 32px 16px 16px;\n"]))),_=l(z||(z=B(["\n  cursor: auto;\n"]))),ee=function(e,t){var n=t?s.blue.light2:s.blue.base,r=l(J||(J=B(["\n    position: relative;\n\n    div {\n      width: ","px;\n      height: ","px;\n      border-radius: 50%;\n      background-color: ",";\n      transform-origin: center;\n      position: relative;\n    }\n  "])),24,24,x(.5,n));return c(r,e?l(Z||(Z=B(["\n        div {\n          box-shadow: 0px 0px 0px 4px ",";\n        }\n      "])),x(.83,n)):l(L||(L=B(["\n      &::before,\n      &::after {\n        content: '';\n        position: absolute;\n        border-radius: 50%;\n        translate: -50% -50%;\n        top: 50%;\n        left: 50%;\n        scale: 0.9;\n        opacity: 0;\n        width: ","px;\n        height: ","px;\n        background: rgba(255, 255, 255, 0);\n        box-shadow: 0px 0px 0px 0px ",";\n      }\n\n      // inner most pulse ring\n      &::before {\n        animation: pulse-outer 2.3s infinite cubic-bezier(0.42, 0, 0.61, 0.69);\n      }\n\n      // outer mosts pulse ring\n      &::after {\n        animation: pulse-outer-2 2.3s infinite cubic-bezier(0.42, 0, 0.46, 0.72);\n      }\n\n      @keyframes pulse-outer {\n        10% {\n          box-shadow: 0px 0px 0px 0px ",";\n          opacity: 1;\n        }\n\n        40%,\n        100% {\n          // this should scale up to 1 and have 0 opacity by 42% and remain that way until 100%\n          scale: 1;\n          box-shadow: 0px 0px 0px 15px ",";\n          opacity: 0;\n        }\n      }\n\n      @keyframes pulse-outer-2 {\n        10% {\n          box-shadow: 0px 0px 0px 0px ",";\n          opacity: 1;\n        }\n\n        35%,\n        100% {\n          // this should scale up to 1 and have 0 opacity by 35% and remain that way until 100%. This is 35% so that it gives the illusion of disappearing before the first ring.\n          scale: 1;\n          box-shadow: 0px 0px 0px 18px ",";\n          opacity: 0;\n        }\n      }\n\n      div {\n        animation: pulse-inner 2.3s infinite cubic-bezier(0.42, 0, 0.58, 0.72);\n\n        @keyframes pulse-inner {\n          40% {\n            // at 0% this will start to slowly scale and by 40% this should scale to 1.3\n            scale: 1.3;\n          }\n          73% {\n            // By 73% this should scale back to 1. From 73% to 100% it will remain at 1.\n            scale: 1;\n          }\n        }\n      }\n    "])),24,24,x(1,n),x(.95,n),x(.7,n),x(.95,n),x(.7,n)))},te=l(G||(G=B(["\n  margin-bottom: 16px;\n"]))),ne=l(H||(H=B(["\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  gap: 16px;\n"]))),re=T(T({},O.Light,l(q||(q=B(["\n    color: ",";\n  "])),s.gray.light1)),O.Dark,l(V||(V=B(["\n    color: ",";\n  "])),s.black)),oe=l(Y||(Y=B(["\n  margin-bottom: 4px;\n"]))),ae=l(U||(U=B(["\n  position: absolute;\n  top: 10px;\n  right: 10px;\n"]))),ie=l(X||(X=B(["\n  color: ",";\n  &:hover,\n  &:active {\n    &::before {\n      background-color: ",";\n    }\n  }\n"])),s.gray.dark2,s.gray.light3),le=T(T({},O.Light,l($||($=B(["\n    color: ",";\n  "])),s.gray.base)),O.Dark,l(K||(K=B(["\n    color: ",";\n  "])),s.gray.dark2)),ce=l(Q||(Q=B(["\n  height: 28px;\n"]))),se=["darkMode","open","setOpen","tooltipJustify","tooltipAlign","refEl","portalClassName","portalContainer","scrollContainer","popoverZIndex","theme","title","isStandalone","buttonText","numberOfSteps","currentStep","children","tooltipClassName","onEscClose","handleButtonClick","handleCloseClick","usePortal"],ue="guide-cue-label",pe="guide-cue-desc";function me(t){var n=t.darkMode,r=t.open,o=t.setOpen,a=t.tooltipJustify,l=t.tooltipAlign,s=t.refEl,u=t.portalClassName,p=t.portalContainer,m=t.scrollContainer,b=t.popoverZIndex,y=t.theme,g=t.title,v=t.isStandalone,E=t.buttonText,x=t.numberOfSteps,O=t.currentStep,N=t.children,j=t.tooltipClassName,M=t.onEscClose,B=t.handleButtonClick,I=t.handleCloseClick,D=t.usePortal,F=void 0===D||D,R=P(t,se),z=h({prefix:"guide-cue"});return e.createElement(e.Fragment,null,e.createElement(w,A({darkMode:n,open:r,setOpen:o,justify:a,align:l,refEl:s,className:c(T({},W,!v),_,j),portalClassName:u,portalContainer:p,scrollContainer:m,popoverZIndex:b,onClose:M,role:"dialog","aria-labelledby":ue,usePortal:F},R),e.createElement(C,{focusTrapOptions:{clickOutsideDeactivates:!0}},e.createElement("div",null,!v&&e.createElement(S,{className:c(ae,T({},ie,n)),"aria-label":"Close Tooltip",onClick:I,darkMode:!n},e.createElement(k,null)),e.createElement("div",{className:te},e.createElement(f,{id:ue,as:"h2",className:oe,darkMode:!n},e.createElement("strong",null,g)),e.createElement(f,{as:"div",className:re[y],id:pe},N)),e.createElement("div",{className:ne},!v&&e.createElement(d,{className:le[y]},O," of ",x),e.createElement(i,{variant:"primary",onClick:function(){return B()},darkMode:!n,className:ce,id:z},E))))))}me.displayName="TooltipContent";var fe,de,be,ye,ge,he,ve,Ee={Top:p.Top,Bottom:p.Bottom,Left:p.Left,Right:p.Right},xe={Start:m.Start,Middle:m.Middle,End:m.End},Oe=["open","setOpen","refEl","numberOfSteps","currentStep","darkMode","title","children","onDismiss","onPrimaryButtonClick","tooltipClassName","portalClassName","buttonText","tooltipAlign","tooltipJustify","beaconAlign","portalContainer","portalRef","scrollContainer","popoverZIndex"];function Ce(o){var a=o.open,i=o.setOpen,l=o.refEl,c=o.numberOfSteps,s=o.currentStep,m=void 0===s?1:s,f=o.darkMode,d=o.title,y=o.children,h=o.onDismiss,x=void 0===h?function(){}:h,O=o.onPrimaryButtonClick,C=void 0===O?function(){}:O,k=o.tooltipClassName,S=o.portalClassName,w=o.buttonText,j=o.tooltipAlign,M=void 0===j?Ee.Top:j,B=o.tooltipJustify,D=void 0===B?xe.Middle:B,F=o.beaconAlign,R=void 0===F?p.CenterHorizontal:F,z=o.portalContainer,J=o.portalRef,Z=o.scrollContainer,L=o.popoverZIndex,G=P(o,Oe),H=E(f),q=H.darkMode,V=H.theme,Y=g(),U=I(t(!1),2),X=U[0],$=U[1],K=I(t(!1),2),Q=K[0],W=K[1],_=n(null),te=w||(m===c||1===c?"Got it":"Next"),ne=c<=1;r((function(){var e,t;return a&&!ne?($(!0),e=setTimeout((function(){return b((function(){W(!0)}))}),400)):(W(!1),t=setTimeout((function(){return $(!1)}),100)),function(){clearTimeout(e),clearTimeout(t)}}),[a,ne]);var re={portalClassName:S,portalContainer:z,portalRef:J,scrollContainer:Z},oe=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({darkMode:q,open:a,setOpen:i,tooltipJustify:D,tooltipAlign:M,refEl:l,popoverZIndex:L,numberOfSteps:c,currentStep:m,theme:V,title:d,isStandalone:ne,buttonText:te,tooltipClassName:k,onEscClose:ne?C:x,handleButtonClick:function(){i(!1),setTimeout((function(){return C()}),ne?0:400)},handleCloseClick:function(){i(!1),setTimeout((function(){return x()}),400)}},G),ae=I(t(!1),2),ie=ae[0],le=ae[1];return v((function(){return le(!0)}),[]),ie?e.createElement(e.Fragment,null,ne?e.createElement(me,A({},oe,re),y):e.createElement(u,A({active:X,refEl:l,align:R,justify:xe.Middle,spacing:-12,adjustOnMutation:!0,popoverZIndex:L},re),e.createElement("div",{ref:_,className:ee(Y,q)},e.createElement("div",null)),e.createElement(me,A({},oe,{refEl:_,open:Q,usePortal:!1}),y))):null}Ce.displayName="GuideCue",Ce.propTypes={children:y.node,darkMode:y.bool,open:y.bool,setOpen:y.func,refEl:y.shape({current:"undefined"!=typeof window?y.instanceOf(Element):y.any}),numberOfSteps:y.number.isRequired,currentStep:function(e,t){return e.numberOfSteps>1&&"number"!=typeof e[t]?new Error("`currentStep` prop of type `number` is required if numberOfSteps > 1"):e.numberOfSteps<=1&&void 0!==e[t]&&"number"!=typeof e[t]?new Error("'currentStep' prop is invalid. Type '".concat(M(e[t]),"' supplied to 'currentStep', expected 'number'")):void 0},title:y.string,tooltipClassName:y.string,buttonText:y.string,onDismiss:y.func,onPrimaryButtonClick:y.func,tooltipAlign:y.oneOf(Object.values(Ee)),tooltipJustify:y.oneOf(Object.values(xe)),beaconAlign:y.oneOf(Object.values(p)),popoverZIndex:y.number,scrollContainer:"undefined"!=typeof window?y.instanceOf(Element):y.any,portalContainer:"undefined"!=typeof window?y.instanceOf(Element):y.any,portalClassName:y.string,portalRef:y.shape({current:"undefined"!=typeof window?y.instanceOf(Element):y.any})};var ke,Se={title:"Components/GuideCue",component:Ce,decorators:[function(t){return e.createElement("div",null,e.createElement(t,null))}],parameters:{default:"LiveExample",controls:{exclude:[].concat((ke=a,function(e){if(Array.isArray(e))return F(e)}(ke)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(ke)||D(ke)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),["refEl","setOpen","tooltipClassName","open","onPrimaryButtonClick"])},chromatic:{disableSnapshot:!0},generate:{storyNames:["Standalone","MultiStepBeaconTop","MultiStepBeaconBottom","MultiStepBeaconLeft","MultiStepBeaconRight","MultiStepBeaconCenterVertical","MultiStepBeaconCenterHorizontal"],combineArgs:{darkMode:[!1,!0],tooltipJustify:Object.values(xe),tooltipAlign:Object.values(Ee)},args:{open:!0,refEl:void 0},decorator:function(t){var n=e.useRef(null);return e.createElement("div",{className:l(fe||(fe=B(["\n              height: ","px;\n              width: ","px;\n              display: flex;\n              align-items: center;\n              justify-content: center;\n            "])),375,580)},e.createElement("div",{className:l(de||(de=B(["\n                height: ","px;\n                width: ","px\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                outline: 1px solid ","80;\n              "])),25,30,s.gray.base),ref:n},"refEl"),e.createElement(t,{refEl:n}))}}},argTypes:{darkMode:o.darkMode,numberOfSteps:{control:"number"},currentStep:{control:"number"},children:{control:"text"},buttonText:{control:"text"}},args:{title:"New feature",children:"This is a new feature. You should try it out",buttonText:"Next",numberOfSteps:4,currentStep:2}},we=function(r){var o=I(t(!1),2),a=o[0],c=o[1],s=n(null),u=r.children,p=r.darkMode;return e.createElement("div",null,e.createElement(i,{onClick:function(){return c((function(e){return!e}))},className:l(be||(be=B(["\n          margin-bottom: 100px;\n        "]))),darkMode:p},"Open me"),e.createElement("div",{ref:s},e.createElement(f,{darkMode:p},"story refEl trigger")),e.createElement(Ce,A({},r,{darkMode:p,open:a,setOpen:c,refEl:s,onPrimaryButtonClick:function(){return console.log("next")},onDismiss:function(){return console.log("close")},"aria-labelledby":"test"}),u))}.bind({});we.parameters={chromatic:{disableSnapshot:!0}};var Ne=l(ye||(ye=B(["\n  width: 800px;\n  height: 100vh;\n  background-color: #e8edeb;\n  overflow: scroll;\n  position: relative;\n"]))),je=l(ge||(ge=B(["\n  position: relative;\n  height: 130vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),Me=function(r){var o=I(t(!1),2),a=o[0],c=o[1],s=n(null),u=n(null),p=r.children,m=r.darkMode;return e.createElement("div",{className:Ne},e.createElement("div",{className:je,ref:u},e.createElement(e.Fragment,null,e.createElement(i,{onClick:function(){return c((function(e){return!e}))},className:l(he||(he=B(["\n              margin-bottom: 100px;\n            "]))),darkMode:m},"Open me"),e.createElement("div",{ref:s},e.createElement(f,{darkMode:m},"story refEl trigger")),e.createElement(Ce,A({},r,{darkMode:m,open:a,setOpen:c,refEl:s,portalContainer:u.current,scrollContainer:u.current}),p))))};Me.parameters={chromatic:{disableSnapshot:!0}};var Te=l(ve||(ve=B(["\n  margin-bottom: 30px;\n"]))),Ae=function(r){var o=r.darkMode,a=I(t(!1),2),l=a[0],c=a[1],s=I(t(1),2),u=s[0],p=s[1],m=n(null),d=n(null),b=n(null),y=[m,d,b],g=y.length;return e.createElement("div",null,e.createElement(i,{className:Te,onClick:function(){p(1),c(!0)}},"Begin tour"),e.createElement("div",{ref:m},e.createElement(f,{className:Te,darkMode:o},"story refEl trigger1")),e.createElement("div",{ref:d},e.createElement(f,{className:Te,darkMode:o},"story refEl trigger2")),e.createElement("div",{ref:b},e.createElement(f,{className:Te,darkMode:o},"story refEl trigger3")),e.createElement(Ce,{darkMode:o,open:l,setOpen:c,refEl:y[u-1],numberOfSteps:g,currentStep:u,onPrimaryButtonClick:function(){u!==g&&(p((function(e){return e+1})),c(!0))},onDismiss:function(){console.log("dismissed")},title:"New feature"},"This is a new feature. You should try it out"))};Ae.parameters={chromatic:{disableSnapshot:!0},controls:{exclude:["title","children","buttonText","numberOfSteps","currentStep","tooltipAlign","tooltipJustify","beaconAlign","className","refEl","setOpen","tooltipClassName","open","onDismiss","onPrimaryButtonClick"]}};var Pe=function(){return e.createElement(e.Fragment,null)};Pe.parameters={generate:{args:{numberOfSteps:1,currentStep:1}}};var Be=function(){return e.createElement(e.Fragment,null)};Be.parameters={generate:{args:{beaconAlign:p.Top}}};var Ie=function(){return e.createElement(e.Fragment,null)};Ie.parameters={generate:{args:{beaconAlign:p.Bottom}}};var De=function(){return e.createElement(e.Fragment,null)};De.parameters={generate:{args:{beaconAlign:p.Left}}};var Fe=function(){return e.createElement(e.Fragment,null)};Fe.parameters={generate:{args:{beaconAlign:p.Right}}};var Re=function(){return e.createElement(e.Fragment,null)};Re.parameters={generate:{args:{beaconAlign:p.CenterVertical}}};var ze=function(){return e.createElement(e.Fragment,null)};ze.parameters={generate:{args:{beaconAlign:p.CenterHorizontal}}};export{we as LiveExample,Ie as MultiStepBeaconBottom,ze as MultiStepBeaconCenterHorizontal,Re as MultiStepBeaconCenterVertical,De as MultiStepBeaconLeft,Fe as MultiStepBeaconRight,Be as MultiStepBeaconTop,Ae as MultistepDemo,Me as ScrollableContainer,Pe as Standalone,Se as default};
