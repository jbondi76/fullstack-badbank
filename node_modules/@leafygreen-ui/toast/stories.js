import e,{useCallback as n,useState as t,useMemo as r,useRef as o,useEffect as a,useReducer as i,useContext as s}from"react";import{faker as l}from"@faker-js/faker";import{storybookExcludedControlParams as c}from"@lg-tools/storybook-utils";import u from"lodash/range";import d from"lodash/startCase";import p from"@leafygreen-ui/button";import{css as m,keyframes as f,cx as g}from"@leafygreen-ui/emotion";import{anchorClassName as h,Body as v,Link as b,Label as y,InlineCode as x}from"@leafygreen-ui/typography";import k from"@leafygreen-ui/icon/dist/CheckmarkWithCircle";import E from"@leafygreen-ui/icon/dist/ImportantWithCircle";import w from"@leafygreen-ui/icon/dist/InfoWithCircle";import T from"@leafygreen-ui/icon/dist/Refresh";import C from"@leafygreen-ui/icon/dist/Warning";import O from"lodash/defaults";import S from"prop-types";import j from"@leafygreen-ui/icon/dist/X";import N from"@leafygreen-ui/icon-button";import P,{useDarkMode as I}from"@leafygreen-ui/leafygreen-provider";import{transparentize as H,mix as D}from"polished";import{Theme as L,createUniqueClassName as z,createSyntheticEvent as A,keyMap as M}from"@leafygreen-ui/lib";import{palette as W}from"@leafygreen-ui/palette";import{spacing as F,fontFamilies as V,typeScales as R,transitionDuration as U,fontWeights as Y}from"@leafygreen-ui/tokens";import q from"lodash/clamp";import"lodash/defaultsDeep";import{TransitionGroup as B,Transition as _}from"react-transition-group";import{useIdAllocator as G,useDynamicRefs as K,useStateRef as X,useMutationObserver as $,useBackdropClick as J}from"@leafygreen-ui/hooks";import Q from"@leafygreen-ui/portal";import Z from"lodash/isUndefined";import ee from"lodash/debounce";import"lodash/isEqual";function ne(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function te(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ne(Object(t),!0).forEach((function(n){oe(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ne(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function re(e){var n=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof n?n:n+""}function oe(e,n,t){return(n=re(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ae(){return ae=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},ae.apply(this,arguments)}function ie(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function se(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}function le(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,a,i,s=[],l=!0,c=!1;try{if(a=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;l=!1}else for(;!(l=(r=a.call(t)).done)&&(s.push(r.value),s.length!==n);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(c)throw o}}return s}}(e,n)||ue(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ce(e){return function(e){if(Array.isArray(e))return de(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ue(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ue(e,n){if(e){if("string"==typeof e)return de(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?de(e,n):void 0}}function de(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var pe={Success:"success",Note:"note",Warning:"warning",Important:"important",Progress:"progress"},me=oe(oe(oe(oe(oe({},pe.Success,k),pe.Note,w),pe.Warning,C),pe.Important,E),pe.Progress,T),fe=["id"];function ge(e){return te({id:function(e){var n;do{n="toast-"+(1e4*Math.random()).toFixed(0).padStart(4,"0")}while(void 0!==e);return n}()},e)}var he,ve,be,ye,xe,ke,Ee,we,Te,Ce,Oe,Se,je,Ne,Pe,Ie,He,De,Le,ze,Ae,Me,We,Fe,Ve,Re,Ue,Ye,qe,Be,_e,Ge,Ke,Xe,$e={variant:pe.Note,progress:1,timeout:6e3,dismissible:!0},Je=400,Qe=56,Ze=4,en=24,nn=4,tn=8,rn=100,on=4,an=3,sn=oe(oe({},L.Light,W.black),L.Dark,W.gray.light2),ln=m(he||(he=se(["\n  position: fixed;\n  left: ","px;\n  bottom: ","px;\n  width: calc(100vw - ","px);\n  max-width: ","px;\n  min-height: ","px; // -2 for border: ;\n\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: ","px; // -1 for border\n  padding-left: ","px;\n  gap: ","px;\n\n  font-family: ",";\n  font-size: ","px;\n  line-height: ","px;\n  border-radius: 12px;\n  border: 1px solid;\n  box-shadow: 0px 18px 18px -15px ",";\n\n  overflow: hidden;\n  transform-origin: bottom center;\n  transition: all ","ms ease-in-out;\n\n  .",", a {\n    font-size: inherit;\n    line-height: inherit;\n    font-weight: ",";\n    text-decoration: underline;\n    text-underline-offset: 3px;\n    text-decoration-thickness: 2px;\n    border-radius: 4px;\n\n    &:hover,\n    &:focus,\n    &:focus-visible {\n      outline: none;\n      span {\n        &::after {\n          display: none;\n        }\n      }\n    }\n    &:focus-visible {\n      position: relative;\n    }\n  }\n"])),nn,nn,2*nn,Je,Qe-2,F[2]-1,F[3],F[3],V.default,R.body1.fontSize,R.body1.lineHeight,H(.8,"#06161E"),U.default,h,Y.bold),cn=oe(oe({},L.Light,m(ve||(ve=se(["\n    background-color: ",";\n    border-color: ",";\n\n    .",", a {\n      color: ",";\n\n      &:hover,\n      &:focus-visible {\n        color: ",";\n      }\n    }\n  "])),sn[L.Light],W.gray.dark2,h,W.gray.light3,W.gray.light2)),L.Dark,m(be||(be=se(["\n    background-color: ",";\n    border-color: ",";\n\n    .",", a {\n      color: ",";\n\n      &:hover,\n      &:focus-visible {\n        color: ",";\n      }\n    }\n  "])),sn[L.Dark],W.gray.light1,h,W.gray.dark3,W.gray.dark2)),un=m(ye||(ye=se(["\n  display: flex;\n  align-items: center;\n  gap: ","px;\n  width: 100%;\n  opacity: 0;\n  transition: opacity ease-out ","ms;\n"])),F[3],U.default),dn=m(xe||(xe=se(["\n  opacity: 1;\n"]))),pn=m(ke||(ke=se(["\n  height: 24px;\n  width: 24px;\n  flex-shrink: 0;\n"]))),mn=m(Ee||(Ee=se(["\n  width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n"]))),fn=m(we||(we=se(["\n  font-weight: ",";\n  overflow: hidden;\n"])),Y.bold),gn=oe(oe({},L.Light,m(Te||(Te=se(["\n    color: ",";\n  "])),W.white)),L.Dark,m(Ce||(Ce=se(["\n    color: ",";\n  "])),W.black)),hn=m(Oe||(Oe=se(["\n  overflow: hidden;\n"]))),vn=oe(oe({},L.Light,m(Se||(Se=se(["\n    color: ",";\n  "])),W.gray.light2)),L.Dark,m(je||(je=se(["\n    color: ",";\n  "])),W.gray.dark2)),bn=m(Ne||(Ne=se(["\n  width: ","px;\n  height: ","px;\n  // Counteract the margin added by hover state\n  margin: -","px;\n  align-self: flex-start;\n  transition: color ","ms ease-in-out;\n\n  &:focus-visible {\n    outline: none;\n  }\n"])),F[3]+F[2],F[3]+F[2],F[1],U.default),yn=oe(oe({},L.Light,m(Pe||(Pe=se(["\n    color: ",";\n  "])),W.gray.base)),L.Dark,m(Ie||(Ie=se(["\n    color: ",";\n\n    &:hover,\n    &:focus-visible {\n      &::before {\n        background-color: ",";\n      }\n    }\n  "])),W.gray.dark2,W.gray.light1)),xn=oe(oe(oe(oe(oe({},pe.Success,oe(oe({},L.Light,m(He||(He=se(["\n      color: ",";\n    "])),W.green.base)),L.Dark,m(De||(De=se(["\n      color: ",";\n    "])),W.green.dark1))),pe.Note,oe(oe({},L.Light,m(Le||(Le=se(["\n      color: ",";\n    "])),W.blue.light1)),L.Dark,m(ze||(ze=se(["\n      color: ",";\n    "])),W.blue.base))),pe.Warning,oe(oe({},L.Light,m(Ae||(Ae=se(["\n      color: ",";\n    "])),W.red.light1)),L.Dark,m(Me||(Me=se(["\n      color: ",";\n    "])),W.red.base))),pe.Important,oe(oe({},L.Light,m(We||(We=se(["\n      color: ",";\n    "])),W.yellow.base)),L.Dark,m(Fe||(Fe=se(["\n      color: ",";\n    "])),W.yellow.dark2))),pe.Progress,oe(oe({},L.Light,m(Ve||(Ve=se(["\n      color: ",";\n    "])),W.gray.light2)),L.Dark,m(Re||(Re=se(["\n      color: ",";\n    "])),W.gray.dark2))),kn=m(Ue||(Ue=se(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  height: ","px;\n  background-color: ",";\n"])),Ze,W.gray.light2),En=oe(oe({},L.Dark,m(Ye||(Ye=se(["\n    background-color: ",";\n  "])),W.gray.light1)),L.Light,m(qe||(qe=se(["\n    background-color: ",";\n  "])),W.gray.dark2)),wn=f(Be||(Be=se(["\n  0% {\n    background-position: ","px;\n  }\n\n  100% {\n    background-position: ","px;\n  }\n"])),-Je,2*Je),Tn=m(_e||(_e=se(["\n  overflow: hidden;\n  height: ","px;\n  background-size: ","px;\n  animation: "," 4s infinite linear;\n  transition: width ","ms ease-in-out;\n"])),Ze,2*Je,wn,U.slower),Cn=oe(oe({},L.Light,m(Ge||(Ge=se(["\n    background-color: #083c90;\n    background-image: linear-gradient(\n      90deg,\n      #083c90 0px,\n      #c3e7fe ","px,\n      #083c90 ","px\n    );\n  "])),Je/2,Je)),L.Dark,m(Ke||(Ke=se(["\n    background-color: #0498ec;\n    background-image: linear-gradient(\n      90deg,\n      #0498ec 0px,\n      #c3e7fe ","px,\n      #0498ec ","px\n    );\n  "])),Je/2,Je));function On(n){var t=n.progress,r=n.theme,o=100*q(t,0,1);return e.createElement("div",{className:g(kn,En[r]),role:"progressbar","aria-valuenow":o,"aria-valuemin":0,"aria-valuemax":100},e.createElement("div",{className:g(Tn,Cn[r],m(Xe||(Xe=se(["\n            width: ","%;\n          "])),o))}))}On.displayName="ToastProgressBar",On.propTypes={progress:S.number};var Sn,jn,Nn,Pn,In,Hn,Dn,Ln=["id","title","description","className","onClose","actionElement","index","isHovered","isControlled","variant","progress","dismissible","darkMode"],zn=e.forwardRef((function(n,t){var r=n.id,o=n.title,a=n.description,i=n.className,s=n.onClose,l=n.actionElement,c=n.index,u=void 0===c?0:c,d=n.isHovered;n.isControlled;var p=n.variant,m=n.progress,f=n.dismissible,h=n.darkMode,b=ie(n,Ln),y=O({variant:p,progress:m,dismissible:f},$e),x=y.variant,k=y.progress,E=y.dismissible;E||b.timeout||console.warn("Toast ".concat(r," may never close. Toast must be `dismissible` or have a `timeout` value."));var w=I(h),T=w.theme,C=w.darkMode,S=0===u||d,H=me[x],D=xn[x];return e.createElement(P,{darkMode:!C},e.createElement("div",ae({id:r,ref:t,className:g(ln,cn[T],i),"aria-atomic":"true","data-testid":"lg-toast"},b),e.createElement("div",{"data-testid":"lg-toast-content","aria-hidden":!S,className:g(un,oe({},dn,S))},e.createElement(H,{"aria-hidden":!0,className:g(pn,D[T]),size:32}),e.createElement("div",{className:mn},e.createElement(v,{"data-testid":"toast-title",className:g(fn,gn[T])},o),a&&e.createElement(v,{className:g(hn,vn[T])},a)),x===pe.Progress&&l),E&&e.createElement(N,{className:g(bn,yn[T]),"aria-label":"Close Message",onClick:s,darkMode:!C,"data-testid":"lg-toast-dismiss-button"},e.createElement(j,{"aria-hidden":!0,role:"presentation"})),x===pe.Progress&&S&&e.createElement(On,{theme:T,progress:k})))}));zn.displayName="InternalToast",zn.propTypes={title:S.oneOfType([S.element,S.string]).isRequired,description:S.oneOfType([S.element,S.string]),variant:S.oneOf(Object.values(pe)),progress:S.number,onClose:S.func,dismissible:S.bool};var An,Mn,Wn,Fn,Vn,Rn,Un,Yn,qn,Bn,_n,Gn,Kn,Xn,$n,Jn=m(Sn||(Sn=se(["\n  border: unset;\n  outline: unset;\n\n  position: absolute;\n  left: ","px;\n  bottom: ","px;\n  width: ","px;\n  height: ","px;\n  z-index: 0;\n\n  font-family: ",";\n  font-size: ","px;\n  line-height: ","px;\n  border-radius: ","px;\n  cursor: pointer;\n\n  opacity: 0;\n  transform: translate3d(0, ","px, -400px);\n  transition: ","ms ease-in-out;\n  transition-property: background-color, opacity, transform;\n"])),nn,nn,Je,en,V.default,R.body1.fontSize,R.body1.lineHeight,F[2],tn,U.slower),Qn=oe(oe({},L.Light,m(jn||(jn=se(["\n    background-color: ",";\n    color: ",";\n\n    &:hover {\n      background-color: ",";\n    }\n  "])),W.gray.dark2,W.white,W.gray.dark3)),L.Dark,m(Nn||(Nn=se(["\n    background-color: ",";\n    color: ",";\n\n    &:hover {\n      background-color: ",";\n    }\n  "])),W.gray.light1,W.black,W.gray.light2)),Zn={entered:m(Pn||(Pn=se(["\n    transform: translate3d(0, 0, 0);\n    opacity: 1;\n  "]))),entering:m(In||(In=se(["\n    transform: translate3d(0, 0, 0);\n    opacity: 1;\n  "]))),exited:m(Hn||(Hn=se(["\n    transform: translate3d(\n      0,\n      ","px,\n      -","px\n    );\n    opacity: 0;\n  "])),an*tn,(an+1)*rn),exiting:m(Dn||(Dn=se(["\n    transform: translate3d(\n      0,\n      ","px,\n      -","px\n    );\n    opacity: 0;\n  "])),an*tn,(an+1)*rn)},et=function(n){var t=n.count,r=n.onClick,o=n.className,a=I().theme;return t?e.createElement("button",{onClick:r,className:g(Jn,Qn[a],o)},t," more notification",t>1&&"s"):null},nt=!1,tt=m(An||(An=se(["\n  position: relative;\n"]))),rt=m(Mn||(Mn=se(["\n  position: fixed;\n  display: flex;\n  flex-direction: column-reverse;\n\n  left: ","px;\n  bottom: ","px;\n  width: ","px;\n  max-height: calc(100vh - ","px);\n  z-index: 0;\n  overflow: unset;\n\n  // Hide the toast initially\n  min-height: ","px;\n  opacity: 0;\n  visibility: hidden;\n\n  perspective: 1600px;\n  perspective-origin: bottom;\n  transform-style: preserve-3d;\n  transition: ease-in-out ","ms;\n  transition-property: transform, bottom, opacity;\n\n  /* Scrollbars */\n  scroll-behavior: unset; // _not_ smooth. We need this to be instant\n  scrollbar-width: none; /* Firefox */\n  -ms-overflow-style: none; /* IE and old Edge */\n  &::-webkit-scrollbar {\n    display: none; /* Chrome, Safari and Opera */\n  }\n\n  /* Debug */\n  ","\n  ","\n"])),F[3]-nn,F[3]-nn,Je+2*nn,F[3],0,U.slower,nt,nt),ot=m(Wn||(Wn=se(["\n  opacity: 1;\n  visibility: visible;\n"])));function at(e){var n=e.recentToastsLength,t=e.topToastHeight;return m(Fn||(Fn=se(["\n    // In the default state, the container is the height of the first toast + inset\n    height: ","px;\n\n    // Move the entire container up as toasts get added,\n    // so the bottom toast is always 16px from the bottom\n    // (note, recentToastsLength should never exceed 3 )\n    transform: translateY(\n      -","px\n    );\n  "])),t+2*nn,tn*(n-1))}var it=function(e){var n=e.totalStackHeight,t=e.bottomOffset+n+2*nn;return m(Vn||(Vn=se(["\n    height: ","px;\n    // set the container back when hovered/expanded\n    transform: translateY(0);\n  "])),t)},st=m(Rn||(Rn=se(["\n  // When expanded, force the height to 100vh regardless of the total stack height\n  height: 100vh;\n  bottom: 0;\n  transform: translateY(0);\n  overflow: auto;\n"]))),lt=m(Un||(Un=se(["\n  bottom: ","px;\n"])),F[3]-nn),ct=m(Yn||(Yn=se(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  margin: 0;\n  transform-style: inherit;\n  transition: margin ","ms ease-in-out;\n\n  /* Debug */\n  ","\n"])),U.default,nt);function ut(e){return m(qn||(qn=se(["\n    margin: ","px 0;\n    height: ","px;\n  "])),F[3],e)}var dt=m(Bn||(Bn=se(["\n  margin: 0;\n"])));function pt(e){var n=e.state,t=e.theme,r=e.index;switch(n){case"entered":var o=r*tn,a=-r*rn,i=D(1-.2*r,sn[t],W.white);return m(_n||(_n=se(["\n        opacity: 1;\n        z-index: ",";\n        transform: translate3d(0, ","px, ","px) scale(1);\n        background-color: ",";\n        // Slow down any hover animations\n        transition-duration: ","ms;\n\n        ","\n      "])),3-r,o,a,i,U.slower,nt);case"exiting":return m(Gn||(Gn=se(["\n        opacity: 0;\n      "])));default:return m(Kn||(Kn=se(["\n        transform: translate3d(\n            0,\n            ","px,\n            -","px\n          )\n          scale(0.9);\n        opacity: 0;\n      "])),tn,rn)}}function mt(e){var n=e.theme,t=e.index,r=e.topToastHeight;return m(Xn||(Xn=se(["\n    max-height: ",";\n    color: "," !important;\n  "])),0===t?"unset":"".concat(r,"px"),t>0?sn[n]:"initial")}function ft(e){var n=e.positionY,t=e.height,r=e.theme;return m($n||($n=se(["\n    max-height: ","px;\n    background-color: ",";\n    transform: translate3d(0, -","px, 0);\n  "])),2*t,sn[r],n)}var gt=100;function ht(e){return ee((function(){setTimeout(e)}),gt)}var vt,bt,yt,xt,kt,Et=["onClose","className"],wt=z("toast-portal"),Tt=function(i){var s,l=i.stack,c=i.portalClassName,u=Ht(),d=u.popToast,p=u.getToast,m=G({id:"lg-toast-region"}),f=o(null),h=o(null),v=K({prefix:"toast"}),b=I().theme,y=le(t(!1),2),x=y[0],k=y[1],E=function(){return k(!0)},w=function(){return k(!1)},T=le(X(!1),3),C=T[0],O=T[1],S=T[2],j=function(){return O(!0)},N=function(){return O(!1)},P=l.size>0,H=function(e){return Array.from(e).reduce((function(n,t,r){return e.size<=an||r>=e.size-an?n.recentToasts.push(t):n.remainingToasts.push(t),n}),{recentToasts:[],remainingToasts:[]})}(l),D=H.recentToasts,L=H.remainingToasts,z=C?[].concat(ce(L),ce(D)):D,W=x&&!C&&L.length>0,V=W?en+on:0,R=function(e){var o=e.stack,a=e.getToastRef,i=e.shouldExpand,s=n((function(){return Array.from(o).reverse().reduce((function(e,n){var t=le(n,1)[0],r=a(t),o=0;if(null!=r&&r.current&&r.current.firstElementChild){var i=r.current.firstElementChild.clientHeight,s=2*F[2],l=r.current.clientHeight;o=Math.max(i+s,l+2)}return e[t]=o,e}),{})}),[a,o]),l=le(t(s()),2),c=l[0],u=l[1],d=n((function(e,n){if(o.size<=0)return 0;for(var t=0,r=0;r<o.size;r++){var a=le(Array.from(o).reverse()[r],1)[0];r>e&&(n||r<an)&&(t+=c[a]+on)}return t}),[o,c]),p=r((function(){return d(-1,i)}),[d,i]),m=n((function(){u(s())}),[s]),f=r((function(){return ee(m,100)}),[m]);return{toastHeights:c,totalStackHeight:p,calcHeightForIndex:d,updateToastHeights:f}}({stack:l,getToastRef:v,shouldExpand:C}),Y=R.toastHeights,q=R.totalStackHeight,Z=R.calcHeightForIndex,ne=R.updateToastHeights;a(ne,[]);var te=null===(s=Array.from(l).reverse()[0])||void 0===s?void 0:s[0];$(f.current,{childList:!0,attributes:!0,subtree:!0},ne,l.size>0);var re=function(e){var n=e.getShouldExpand,o=e.exitCallback,a=e.enterCallback,i=le(t(!1),2),s=i[0],l=i[1],c=r((function(){return ht((function(){a(),l(n())}))}),[a,n]),u=r((function(){return ht((function(){o(),l(n())}))}),[o,n]);return{isExpanded:s,setIsExpanded:l,handleTransitionExit:u,handleTransitionEnter:c}}({getShouldExpand:S,enterCallback:function(){f.current&&(f.current.scrollTop=q),S()&&ne()},exitCallback:function(){if(h.current){var e=h.current.matches(":hover");k(e)}S()&&ne()}}),se=re.isExpanded,ue=re.setIsExpanded,de=re.handleTransitionExit,pe=re.handleTransitionEnter,me=function(){(x||S())&&ne()},fe=function(){(x||S())&&ne()};J((function(){N(),ue(S())}),h,se&&l.size>0);var ge=n((function(e,n){var t,r=p(e),o=v(e);r&&null!=o&&o.current&&(r.isControlled||d(e),null===(t=r.onClose)||void 0===t||t.call(r,null!=n?n:A(new Event("timeout"),o.current)))}),[p,v,d]);!function(e){var t=e.stack,r=e.isHovered,i=e.callback,s=o(new Map),l=null==t?void 0:t.size,c=n((function(e,n){if(n&&!s.current.has(e)){var t=setTimeout((function(){i(e)}),n);s.current.set(e,t)}}),[i]),u=n((function(e){e.forEach((function(e,n){var t=e.timeout,r=e.variant,o=e.progress;"progress"===r&&1!==o||c(n,t)}))}),[c]);function d(){s.current.forEach((function(e,n){e&&clearTimeout(e),s.current.delete(n)}))}a((function(){return u(t),function(){return d()}}),[c,t,u,l]),a((function(){return r?d():u(t),function(){return d()}}),[r,c,t,u,l])}({stack:l,isHovered:x,callback:ge});return e.createElement(Q,{className:g(tt,wt,c)},e.createElement("div",{ref:f,id:m,"data-testid":"lg-toast-region",role:"status","aria-live":"polite","aria-relevant":"all",onFocus:E,onBlur:w,onKeyDown:function(e){se&&e.key===M.Escape&&N()},className:g(rt,oe(oe(oe(oe(oe({},ot,P),at({topToastHeight:Y[te],recentToastsLength:D.length}),P),it({totalStackHeight:q,bottomOffset:V}),P&&(x||C)),st,P&&se),lt,se&&!C))},e.createElement("div",{ref:h,"data-testid":"lg-toast-scroll-container",onMouseEnter:E,onMouseLeave:w,className:g(ct,oe(oe({},ut(q),se),dt,se&&!C))},e.createElement(B,{enter:!0,exit:!0,component:null},z.reverse().map((function(n,t){var r=le(n,2),o=r[0],a=r[1],i=a.onClose,s=a.className,l=ie(a,Et),c=v(o);return i=function(e){return function(n){return ge(e,n)}}(o),e.createElement(_,{onEntering:me,onEntered:pe,onExiting:fe,onExited:de,key:o,timeout:U.default},(function(n){return e.createElement(zn,ae({},l,{id:o,ref:c,onClose:i,index:t,isHovered:x||C,className:g(pt({state:n,theme:b,index:t}),oe(oe({},mt({theme:b,index:t,topToastHeight:Y[te]}),!(x||C)),ft({positionY:Z(t,se)+V,height:Y[o],theme:b}),x||C),s),description:l.description}))}))}))),e.createElement(_,{in:W&&!C,timeout:U.slower},(function(n){return e.createElement(et,{count:L.length,onClick:j,className:Zn[n]})})))))},Ct={pushToast:function(){return""},popToast:function(){},updateToast:function(){},getToast:function(){},getStack:function(){},clearStack:function(){}},Ot=e.createContext(Ct),St=function(e){return e.Push="push",e.Pop="pop",e.Update="update",e.Clear="clear",e}({}),jt=["id"],Nt=function(e,n){switch(n.type){case St.Push:var t=e.stack,r=n.payload,o=r.id,a=ie(r,jt);return{stack:t.set(o,te(te({},$e),a))};case St.Pop:var i=e.stack,s=n.payload;return i.get(s)&&i.delete(s),{stack:i};case St.Update:var l=e.stack,c=n.payload,u=c.id,d=c.props,p=l.get(u);return p&&l.set(u,te(te({},p),d)),{stack:l};case St.Clear:var m=e.stack;return m.clear(),{stack:m}}},Pt=["stack"],It=function(t){var o=t.children,a=t.initialValue,s=t.portalClassName,l=function(e){var t=le(i(Nt,{stack:null!=e?e:new Map}),2),o=t[0].stack,a=t[1],s=n((function(e){var n=ge(e);return a({type:St.Push,payload:n}),n.id}),[]),l=n((function(e){return o.get(e)}),[o]),c=n((function(e){var n=l(e);return a({type:St.Pop,payload:e}),n}),[l]),u=n((function(e,n){var t={type:St.Update,payload:{id:e,props:n}};return a(t),Nt({stack:o},t).stack.get(e)}),[o]),d=n((function(){a({type:St.Clear})}),[]);return r((function(){return{pushToast:s,popToast:c,updateToast:u,getToast:l,clearStack:d,stack:o}}),[s,c,u,o,l,d])}(a),c=l.stack,u=ie(l,Pt),d=n((function(){return c}),[c]),p=r((function(){return te(te({},u),{},{getStack:d})}),[u,d]);return e.createElement(Ot.Provider,{value:p},o,e.createElement(Tt,{stack:c,portalClassName:s}))},Ht=function(){var e=s(Ot);return!Z(e.getStack())||console.warn("`useToast` hook must be used within a `ToastProvider` context"),e},Dt={title:"Components/Toast",component:zn,decorators:[function(n,t){return e.createElement(It,{initialValue:t.args.initialValue,portalClassName:m(vt||(vt=se(["\n          // Ensures a new stacking context is established\n          z-index: 1;\n        "])))},e.createElement(n,t))}],parameters:{default:"LiveExample",controls:{exclude:[].concat(ce(c),["as","title","description","dismissible","progress","variant"])},generate:{combineArgs:{darkMode:[!1,!0],description:[void 0,"Lorem ipsum dolor sit amet",e.createElement("span",null,"This is a ",e.createElement(b,null,"Link"))],dismissible:[!0,!1],variant:Object.values(pe),progress:[0,1],actionElement:[void 0,e.createElement(p,{size:"small"},"Action")]},args:{title:"This is a toast",className:m(bt||(bt=se(["\n          position: relative;\n        "])))},excludeCombinations:[{progress:1,variant:[pe.Success,pe.Note,pe.Warning,pe.Important]},{actionElement:e.createElement(p,null),variant:[pe.Success,pe.Note,pe.Warning,pe.Important]}]}},argTypes:{timeout:{control:"number",defaultValue:6e3,description:"Dismiss the Toast after `timeout` milliseconds. If timeout is `null | 0`, the Toast will never dismiss automatically."}},args:{darkMode:!1}};l.seed(0);var Lt=function(n){var r=Ht(),o=r.pushToast,i=r.clearStack,s=r.getStack,c=r.updateToast,u=s(),f=u&&Array.from(u).filter((function(e){var n=le(e,2);return n[0],"progress"===n[1].variant})),g=le(t(.1),2),h=g[0],v=g[1];return a((function(){f&&0!==f.length||v(.1)}),[f]),e.createElement("div",null,e.createElement("div",{className:m(yt||(yt=se(["\n          display: grid;\n          grid-template-columns: repeat(3, 1fr);\n          gap: 8px;\n          margin: 1em 0;\n        "])))},Object.values(pe).map((function(t){var r=me[t],a=l.lorem.lines(1);return e.createElement(p,{"data-testid":"trigger-".concat(t),key:t,onClick:function(){o(te(te({},n),{},{title:"I'm a ".concat(t," toast"),description:e.createElement(e.Fragment,null,a,a&&e.createElement(e.Fragment,null,"Â ",e.createElement("a",{href:"http://localhost:9001"},"Anchor tag"),e.createElement(b,{href:"http://localhost:9001"},"Link component"))),variant:t,progress:h,timeout:null}))},leftGlyph:e.createElement(r,null)},d(t)," toast")})),e.createElement(p,{onClick:function(){return i()},variant:"dangerOutline"},"Clear all")),f&&f.length>0&&e.createElement(e.Fragment,null,e.createElement(y,{htmlFor:"progress"},"Progress: "),e.createElement(x,null,h),e.createElement("br",null),e.createElement("input",{value:h,onChange:function(e){var n=Number(e.target.value);v(n),f.forEach((function(e){var t=le(e,1)[0];c(t,{progress:n})}))},type:"range",id:"progress",min:0,max:1,step:.1})))};Lt.parameters={chromatic:{disableSnapshot:!0}};var zt,At,Mt=function(n){var t=Ht(),r=t.pushToast,o=t.clearStack;return e.createElement("div",{className:m(xt||(xt=se(["\n        display: flex;\n        gap: 8px;\n      "])))},e.createElement(p,{"data-testid":"toast-trigger",onClick:function(){var e=n.variant||l.helpers.objectValue(pe);r(te({title:"I'm a ".concat(e," toast"),description:l.lorem.lines(l.number.int({min:1,max:2})),variant:e},n))}},"Push toast"),e.createElement(p,{onClick:function(){return o()}},"Clear all"))};Mt.parameters={chromatic:{disableSnapshot:!0}},Mt.args={initialValue:(zt=u(6).map((function(e){return ge({title:"Initial toast",description:l.lorem.lines(2),variant:l.helpers.objectValue(pe)})})),At=new Map,zt.forEach((function(e){var n=e.id,t=ie(e,fe);At.set(n,t)})),At)};var Wt=function(n){var t=Ht(),r=t.pushToast,o=t.clearStack;return e.createElement("div",null,e.createElement("div",{className:m(kt||(kt=se(["\n          display: flex;\n          gap: 8px;\n        "])))},e.createElement(p,{"data-testid":"toast-trigger",onClick:function(){var e=n.variant||l.helpers.objectValue(pe);r(te({title:"I'm a ".concat(e," toast"),description:l.lorem.lines(l.number.int({min:1,max:2})),variant:e},n))}},"Push toast"),e.createElement(p,{onClick:function(){return o()}},"Clear all")))};Wt.parameters={chromatic:{disableSnapshot:!0}};var Ft=function(){};export{Wt as Basic,Ft as Generated,Lt as LiveExample,Mt as WithInitialToasts,Dt as default};
