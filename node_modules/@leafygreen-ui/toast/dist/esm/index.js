import n,{useCallback as e,useState as t,useMemo as r,useRef as o,useEffect as a,useReducer as i,useContext as s}from"react";import l from"lodash/defaultsDeep";import{TransitionGroup as c,Transition as u}from"react-transition-group";import{css as d,keyframes as f,cx as p}from"@leafygreen-ui/emotion";import{useIdAllocator as m,useDynamicRefs as g,useStateRef as h,useMutationObserver as v,useBackdropClick as b}from"@leafygreen-ui/hooks";import y,{useDarkMode as x}from"@leafygreen-ui/leafygreen-provider";import{Theme as k,createUniqueClassName as w,createSyntheticEvent as E,keyMap as T}from"@leafygreen-ui/lib";import O from"@leafygreen-ui/portal";import{spacing as C,fontFamilies as S,typeScales as j,transitionDuration as N,fontWeights as P}from"@leafygreen-ui/tokens";import H from"lodash/defaults";import D from"prop-types";import z from"@leafygreen-ui/icon/dist/X";import L from"@leafygreen-ui/icon-button";import{anchorClassName as I,Body as A}from"@leafygreen-ui/typography";import{transparentize as M,mix as W}from"polished";import{palette as F}from"@leafygreen-ui/palette";import R from"lodash/clamp";import U from"@leafygreen-ui/icon/dist/CheckmarkWithCircle";import Y from"@leafygreen-ui/icon/dist/ImportantWithCircle";import q from"@leafygreen-ui/icon/dist/InfoWithCircle";import B from"@leafygreen-ui/icon/dist/Refresh";import _ from"@leafygreen-ui/icon/dist/Warning";import K from"lodash/isUndefined";import V from"lodash/debounce";import X from"lodash/isEqual";function $(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function G(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?$(Object(t),!0).forEach((function(e){Q(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):$(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function J(n){var e=function(n,e){if("object"!=typeof n||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var r=t.call(n,e);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n,"string");return"symbol"==typeof e?e:e+""}function Q(n,e,t){return(e=J(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Z(){return Z=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Z.apply(this,arguments)}function nn(n,e){if(null==n)return{};var t,r,o=function(n,e){if(null==n)return{};var t,r,o={},a=Object.keys(n);for(r=0;r<a.length;r++)t=a[r],e.indexOf(t)>=0||(o[t]=n[t]);return o}(n,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(r=0;r<a.length;r++)t=a[r],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(o[t]=n[t])}return o}function en(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function tn(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var t=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=t){var r,o,a,i,s=[],l=!0,c=!1;try{if(a=(t=t.call(n)).next,0===e){if(Object(t)!==t)return;l=!1}else for(;!(l=(r=a.call(t)).done)&&(s.push(r.value),s.length!==e);l=!0);}catch(n){c=!0,o=n}finally{try{if(!l&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(c)throw o}}return s}}(n,e)||on(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rn(n){return function(n){if(Array.isArray(n))return an(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||on(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function on(n,e){if(n){if("string"==typeof n)return an(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?an(n,e):void 0}}function an(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var sn,ln,cn,un,dn,fn,pn,mn,gn,hn,vn,bn,yn,xn,kn,wn,En,Tn,On,Cn,Sn,jn,Nn,Pn,Hn,Dn,zn,Ln,In,An,Mn,Wn,Fn,Rn,Un={Success:"success",Note:"note",Warning:"warning",Important:"important",Progress:"progress"},Yn={variant:Un.Note,progress:1,timeout:6e3,dismissible:!0},qn=400,Bn=56,_n=4,Kn=24,Vn=4,Xn=8,$n=100,Gn=4,Jn=3,Qn=Q(Q({},k.Light,F.black),k.Dark,F.gray.light2),Zn=d(sn||(sn=en(["\n  position: fixed;\n  left: ","px;\n  bottom: ","px;\n  width: calc(100vw - ","px);\n  max-width: ","px;\n  min-height: ","px; // -2 for border: ;\n\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: ","px; // -1 for border\n  padding-left: ","px;\n  gap: ","px;\n\n  font-family: ",";\n  font-size: ","px;\n  line-height: ","px;\n  border-radius: 12px;\n  border: 1px solid;\n  box-shadow: 0px 18px 18px -15px ",";\n\n  overflow: hidden;\n  transform-origin: bottom center;\n  transition: all ","ms ease-in-out;\n\n  .",", a {\n    font-size: inherit;\n    line-height: inherit;\n    font-weight: ",";\n    text-decoration: underline;\n    text-underline-offset: 3px;\n    text-decoration-thickness: 2px;\n    border-radius: 4px;\n\n    &:hover,\n    &:focus,\n    &:focus-visible {\n      outline: none;\n      span {\n        &::after {\n          display: none;\n        }\n      }\n    }\n    &:focus-visible {\n      position: relative;\n    }\n  }\n"])),Vn,Vn,2*Vn,qn,Bn-2,C[2]-1,C[3],C[3],S.default,j.body1.fontSize,j.body1.lineHeight,M(.8,"#06161E"),N.default,I,P.bold),ne=Q(Q({},k.Light,d(ln||(ln=en(["\n    background-color: ",";\n    border-color: ",";\n\n    .",", a {\n      color: ",";\n\n      &:hover,\n      &:focus-visible {\n        color: ",";\n      }\n    }\n  "])),Qn[k.Light],F.gray.dark2,I,F.gray.light3,F.gray.light2)),k.Dark,d(cn||(cn=en(["\n    background-color: ",";\n    border-color: ",";\n\n    .",", a {\n      color: ",";\n\n      &:hover,\n      &:focus-visible {\n        color: ",";\n      }\n    }\n  "])),Qn[k.Dark],F.gray.light1,I,F.gray.dark3,F.gray.dark2)),ee=d(un||(un=en(["\n  display: flex;\n  align-items: center;\n  gap: ","px;\n  width: 100%;\n  opacity: 0;\n  transition: opacity ease-out ","ms;\n"])),C[3],N.default),te=d(dn||(dn=en(["\n  opacity: 1;\n"]))),re=d(fn||(fn=en(["\n  height: 24px;\n  width: 24px;\n  flex-shrink: 0;\n"]))),oe=d(pn||(pn=en(["\n  width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n"]))),ae=d(mn||(mn=en(["\n  font-weight: ",";\n  overflow: hidden;\n"])),P.bold),ie=Q(Q({},k.Light,d(gn||(gn=en(["\n    color: ",";\n  "])),F.white)),k.Dark,d(hn||(hn=en(["\n    color: ",";\n  "])),F.black)),se=d(vn||(vn=en(["\n  overflow: hidden;\n"]))),le=Q(Q({},k.Light,d(bn||(bn=en(["\n    color: ",";\n  "])),F.gray.light2)),k.Dark,d(yn||(yn=en(["\n    color: ",";\n  "])),F.gray.dark2)),ce=d(xn||(xn=en(["\n  width: ","px;\n  height: ","px;\n  // Counteract the margin added by hover state\n  margin: -","px;\n  align-self: flex-start;\n  transition: color ","ms ease-in-out;\n\n  &:focus-visible {\n    outline: none;\n  }\n"])),C[3]+C[2],C[3]+C[2],C[1],N.default),ue=Q(Q({},k.Light,d(kn||(kn=en(["\n    color: ",";\n  "])),F.gray.base)),k.Dark,d(wn||(wn=en(["\n    color: ",";\n\n    &:hover,\n    &:focus-visible {\n      &::before {\n        background-color: ",";\n      }\n    }\n  "])),F.gray.dark2,F.gray.light1)),de=Q(Q(Q(Q(Q({},Un.Success,Q(Q({},k.Light,d(En||(En=en(["\n      color: ",";\n    "])),F.green.base)),k.Dark,d(Tn||(Tn=en(["\n      color: ",";\n    "])),F.green.dark1))),Un.Note,Q(Q({},k.Light,d(On||(On=en(["\n      color: ",";\n    "])),F.blue.light1)),k.Dark,d(Cn||(Cn=en(["\n      color: ",";\n    "])),F.blue.base))),Un.Warning,Q(Q({},k.Light,d(Sn||(Sn=en(["\n      color: ",";\n    "])),F.red.light1)),k.Dark,d(jn||(jn=en(["\n      color: ",";\n    "])),F.red.base))),Un.Important,Q(Q({},k.Light,d(Nn||(Nn=en(["\n      color: ",";\n    "])),F.yellow.base)),k.Dark,d(Pn||(Pn=en(["\n      color: ",";\n    "])),F.yellow.dark2))),Un.Progress,Q(Q({},k.Light,d(Hn||(Hn=en(["\n      color: ",";\n    "])),F.gray.light2)),k.Dark,d(Dn||(Dn=en(["\n      color: ",";\n    "])),F.gray.dark2))),fe=d(zn||(zn=en(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  height: ","px;\n  background-color: ",";\n"])),_n,F.gray.light2),pe=Q(Q({},k.Dark,d(Ln||(Ln=en(["\n    background-color: ",";\n  "])),F.gray.light1)),k.Light,d(In||(In=en(["\n    background-color: ",";\n  "])),F.gray.dark2)),me=f(An||(An=en(["\n  0% {\n    background-position: ","px;\n  }\n\n  100% {\n    background-position: ","px;\n  }\n"])),-qn,2*qn),ge=d(Mn||(Mn=en(["\n  overflow: hidden;\n  height: ","px;\n  background-size: ","px;\n  animation: "," 4s infinite linear;\n  transition: width ","ms ease-in-out;\n"])),_n,2*qn,me,N.slower),he=Q(Q({},k.Light,d(Wn||(Wn=en(["\n    background-color: #083c90;\n    background-image: linear-gradient(\n      90deg,\n      #083c90 0px,\n      #c3e7fe ","px,\n      #083c90 ","px\n    );\n  "])),qn/2,qn)),k.Dark,d(Fn||(Fn=en(["\n    background-color: #0498ec;\n    background-image: linear-gradient(\n      90deg,\n      #0498ec 0px,\n      #c3e7fe ","px,\n      #0498ec ","px\n    );\n  "])),qn/2,qn));function ve(e){var t=e.progress,r=e.theme,o=100*R(t,0,1);return n.createElement("div",{className:p(fe,pe[r]),role:"progressbar","aria-valuenow":o,"aria-valuemin":0,"aria-valuemax":100},n.createElement("div",{className:p(ge,he[r],d(Rn||(Rn=en(["\n            width: ","%;\n          "])),o))}))}ve.displayName="ToastProgressBar",ve.propTypes={progress:D.number};var be,ye,xe,ke,we,Ee,Te,Oe=Q(Q(Q(Q(Q({},Un.Success,U),Un.Note,q),Un.Warning,_),Un.Important,Y),Un.Progress,B),Ce=["id","title","description","className","onClose","actionElement","index","isHovered","isControlled","variant","progress","dismissible","darkMode"],Se=n.forwardRef((function(e,t){var r=e.id,o=e.title,a=e.description,i=e.className,s=e.onClose,l=e.actionElement,c=e.index,u=void 0===c?0:c,d=e.isHovered;e.isControlled;var f=e.variant,m=e.progress,g=e.dismissible,h=e.darkMode,v=nn(e,Ce),b=H({variant:f,progress:m,dismissible:g},Yn),k=b.variant,w=b.progress,E=b.dismissible;E||v.timeout||console.warn("Toast ".concat(r," may never close. Toast must be `dismissible` or have a `timeout` value."));var T=x(h),O=T.theme,C=T.darkMode,S=0===u||d,j=Oe[k],N=de[k];return n.createElement(y,{darkMode:!C},n.createElement("div",Z({id:r,ref:t,className:p(Zn,ne[O],i),"aria-atomic":"true","data-testid":"lg-toast"},v),n.createElement("div",{"data-testid":"lg-toast-content","aria-hidden":!S,className:p(ee,Q({},te,S))},n.createElement(j,{"aria-hidden":!0,className:p(re,N[O]),size:32}),n.createElement("div",{className:oe},n.createElement(A,{"data-testid":"toast-title",className:p(ae,ie[O])},o),a&&n.createElement(A,{className:p(se,le[O])},a)),k===Un.Progress&&l),E&&n.createElement(L,{className:p(ce,ue[O]),"aria-label":"Close Message",onClick:s,darkMode:!C,"data-testid":"lg-toast-dismiss-button"},n.createElement(z,{"aria-hidden":!0,role:"presentation"})),k===Un.Progress&&S&&n.createElement(ve,{theme:O,progress:w})))}));Se.displayName="InternalToast",Se.propTypes={title:D.oneOfType([D.element,D.string]).isRequired,description:D.oneOfType([D.element,D.string]),variant:D.oneOf(Object.values(Un)),progress:D.number,onClose:D.func,dismissible:D.bool};var je,Ne,Pe,He,De,ze,Le,Ie,Ae,Me,We,Fe,Re,Ue,Ye,qe=d(be||(be=en(["\n  border: unset;\n  outline: unset;\n\n  position: absolute;\n  left: ","px;\n  bottom: ","px;\n  width: ","px;\n  height: ","px;\n  z-index: 0;\n\n  font-family: ",";\n  font-size: ","px;\n  line-height: ","px;\n  border-radius: ","px;\n  cursor: pointer;\n\n  opacity: 0;\n  transform: translate3d(0, ","px, -400px);\n  transition: ","ms ease-in-out;\n  transition-property: background-color, opacity, transform;\n"])),Vn,Vn,qn,Kn,S.default,j.body1.fontSize,j.body1.lineHeight,C[2],Xn,N.slower),Be=Q(Q({},k.Light,d(ye||(ye=en(["\n    background-color: ",";\n    color: ",";\n\n    &:hover {\n      background-color: ",";\n    }\n  "])),F.gray.dark2,F.white,F.gray.dark3)),k.Dark,d(xe||(xe=en(["\n    background-color: ",";\n    color: ",";\n\n    &:hover {\n      background-color: ",";\n    }\n  "])),F.gray.light1,F.black,F.gray.light2)),_e={entered:d(ke||(ke=en(["\n    transform: translate3d(0, 0, 0);\n    opacity: 1;\n  "]))),entering:d(we||(we=en(["\n    transform: translate3d(0, 0, 0);\n    opacity: 1;\n  "]))),exited:d(Ee||(Ee=en(["\n    transform: translate3d(\n      0,\n      ","px,\n      -","px\n    );\n    opacity: 0;\n  "])),Jn*Xn,(Jn+1)*$n),exiting:d(Te||(Te=en(["\n    transform: translate3d(\n      0,\n      ","px,\n      -","px\n    );\n    opacity: 0;\n  "])),Jn*Xn,(Jn+1)*$n)},Ke=function(e){var t=e.count,r=e.onClick,o=e.className,a=x().theme;return t?n.createElement("button",{onClick:r,className:p(qe,Be[a],o)},t," more notification",t>1&&"s"):null},Ve=!1,Xe=d(je||(je=en(["\n  position: relative;\n"]))),$e=d(Ne||(Ne=en(["\n  position: fixed;\n  display: flex;\n  flex-direction: column-reverse;\n\n  left: ","px;\n  bottom: ","px;\n  width: ","px;\n  max-height: calc(100vh - ","px);\n  z-index: 0;\n  overflow: unset;\n\n  // Hide the toast initially\n  min-height: ","px;\n  opacity: 0;\n  visibility: hidden;\n\n  perspective: 1600px;\n  perspective-origin: bottom;\n  transform-style: preserve-3d;\n  transition: ease-in-out ","ms;\n  transition-property: transform, bottom, opacity;\n\n  /* Scrollbars */\n  scroll-behavior: unset; // _not_ smooth. We need this to be instant\n  scrollbar-width: none; /* Firefox */\n  -ms-overflow-style: none; /* IE and old Edge */\n  &::-webkit-scrollbar {\n    display: none; /* Chrome, Safari and Opera */\n  }\n\n  /* Debug */\n  ","\n  ","\n"])),C[3]-Vn,C[3]-Vn,qn+2*Vn,C[3],0,N.slower,Ve,Ve),Ge=d(Pe||(Pe=en(["\n  opacity: 1;\n  visibility: visible;\n"])));function Je(n){var e=n.recentToastsLength,t=n.topToastHeight;return d(He||(He=en(["\n    // In the default state, the container is the height of the first toast + inset\n    height: ","px;\n\n    // Move the entire container up as toasts get added,\n    // so the bottom toast is always 16px from the bottom\n    // (note, recentToastsLength should never exceed 3 )\n    transform: translateY(\n      -","px\n    );\n  "])),t+2*Vn,Xn*(e-1))}var Qe=function(n){var e=n.totalStackHeight,t=n.bottomOffset+e+2*Vn;return d(De||(De=en(["\n    height: ","px;\n    // set the container back when hovered/expanded\n    transform: translateY(0);\n  "])),t)},Ze=d(ze||(ze=en(["\n  // When expanded, force the height to 100vh regardless of the total stack height\n  height: 100vh;\n  bottom: 0;\n  transform: translateY(0);\n  overflow: auto;\n"]))),nt=d(Le||(Le=en(["\n  bottom: ","px;\n"])),C[3]-Vn),et=d(Ie||(Ie=en(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  margin: 0;\n  transform-style: inherit;\n  transition: margin ","ms ease-in-out;\n\n  /* Debug */\n  ","\n"])),N.default,Ve);function tt(n){return d(Ae||(Ae=en(["\n    margin: ","px 0;\n    height: ","px;\n  "])),C[3],n)}var rt=d(Me||(Me=en(["\n  margin: 0;\n"])));function ot(n){var e=n.state,t=n.theme,r=n.index;switch(e){case"entered":var o=r*Xn,a=-r*$n,i=W(1-.2*r,Qn[t],F.white);return d(We||(We=en(["\n        opacity: 1;\n        z-index: ",";\n        transform: translate3d(0, ","px, ","px) scale(1);\n        background-color: ",";\n        // Slow down any hover animations\n        transition-duration: ","ms;\n\n        ","\n      "])),3-r,o,a,i,N.slower,Ve);case"exiting":return d(Fe||(Fe=en(["\n        opacity: 0;\n      "])));default:return d(Re||(Re=en(["\n        transform: translate3d(\n            0,\n            ","px,\n            -","px\n          )\n          scale(0.9);\n        opacity: 0;\n      "])),Xn,$n)}}function at(n){var e=n.theme,t=n.index,r=n.topToastHeight;return d(Ue||(Ue=en(["\n    max-height: ",";\n    color: "," !important;\n  "])),0===t?"unset":"".concat(r,"px"),t>0?Qn[e]:"initial")}function it(n){var e=n.positionY,t=n.height,r=n.theme;return d(Ye||(Ye=en(["\n    max-height: ","px;\n    background-color: ",";\n    transform: translate3d(0, -","px, 0);\n  "])),2*t,Qn[r],e)}var st=100;function lt(n){return V((function(){setTimeout(n)}),st)}var ct=["onClose","className"],ut=w("toast-portal"),dt=function(i){var s,l=i.stack,d=i.portalClassName,f=xt(),y=f.popToast,k=f.getToast,w=m({id:"lg-toast-region"}),S=o(null),j=o(null),P=g({prefix:"toast"}),H=x().theme,D=tn(t(!1),2),z=D[0],L=D[1],I=function(){return L(!0)},A=function(){return L(!1)},M=tn(h(!1),3),W=M[0],F=M[1],R=M[2],U=function(){return F(!0)},Y=function(){return F(!1)},q=l.size>0,B=function(n){return Array.from(n).reduce((function(e,t,r){return n.size<=Jn||r>=n.size-Jn?e.recentToasts.push(t):e.remainingToasts.push(t),e}),{recentToasts:[],remainingToasts:[]})}(l),_=B.recentToasts,K=B.remainingToasts,X=W?[].concat(rn(K),rn(_)):_,$=z&&!W&&K.length>0,G=$?Kn+Gn:0,J=function(n){var o=n.stack,a=n.getToastRef,i=n.shouldExpand,s=e((function(){return Array.from(o).reverse().reduce((function(n,e){var t=tn(e,1)[0],r=a(t),o=0;if(null!=r&&r.current&&r.current.firstElementChild){var i=r.current.firstElementChild.clientHeight,s=2*C[2],l=r.current.clientHeight;o=Math.max(i+s,l+2)}return n[t]=o,n}),{})}),[a,o]),l=tn(t(s()),2),c=l[0],u=l[1],d=e((function(n,e){if(o.size<=0)return 0;for(var t=0,r=0;r<o.size;r++){var a=tn(Array.from(o).reverse()[r],1)[0];r>n&&(e||r<Jn)&&(t+=c[a]+Gn)}return t}),[o,c]),f=r((function(){return d(-1,i)}),[d,i]),p=e((function(){u(s())}),[s]),m=r((function(){return V(p,100)}),[p]);return{toastHeights:c,totalStackHeight:f,calcHeightForIndex:d,updateToastHeights:m}}({stack:l,getToastRef:P,shouldExpand:W}),en=J.toastHeights,on=J.totalStackHeight,an=J.calcHeightForIndex,sn=J.updateToastHeights;a(sn,[]);var ln=null===(s=Array.from(l).reverse()[0])||void 0===s?void 0:s[0];v(S.current,{childList:!0,attributes:!0,subtree:!0},sn,l.size>0);var cn=function(n){var e=n.getShouldExpand,o=n.exitCallback,a=n.enterCallback,i=tn(t(!1),2),s=i[0],l=i[1],c=r((function(){return lt((function(){a(),l(e())}))}),[a,e]),u=r((function(){return lt((function(){o(),l(e())}))}),[o,e]);return{isExpanded:s,setIsExpanded:l,handleTransitionExit:u,handleTransitionEnter:c}}({getShouldExpand:R,enterCallback:function(){S.current&&(S.current.scrollTop=on),R()&&sn()},exitCallback:function(){if(j.current){var n=j.current.matches(":hover");L(n)}R()&&sn()}}),un=cn.isExpanded,dn=cn.setIsExpanded,fn=cn.handleTransitionExit,pn=cn.handleTransitionEnter,mn=function(){(z||R())&&sn()},gn=function(){(z||R())&&sn()};b((function(){Y(),dn(R())}),j,un&&l.size>0);var hn=e((function(n,e){var t,r=k(n),o=P(n);r&&null!=o&&o.current&&(r.isControlled||y(n),null===(t=r.onClose)||void 0===t||t.call(r,null!=e?e:E(new Event("timeout"),o.current)))}),[k,P,y]);!function(n){var t=n.stack,r=n.isHovered,i=n.callback,s=o(new Map),l=null==t?void 0:t.size,c=e((function(n,e){if(e&&!s.current.has(n)){var t=setTimeout((function(){i(n)}),e);s.current.set(n,t)}}),[i]),u=e((function(n){n.forEach((function(n,e){var t=n.timeout,r=n.variant,o=n.progress;"progress"===r&&1!==o||c(e,t)}))}),[c]);function d(){s.current.forEach((function(n,e){n&&clearTimeout(n),s.current.delete(e)}))}a((function(){return u(t),function(){return d()}}),[c,t,u,l]),a((function(){return r?d():u(t),function(){return d()}}),[r,c,t,u,l])}({stack:l,isHovered:z,callback:hn});return n.createElement(O,{className:p(Xe,ut,d)},n.createElement("div",{ref:S,id:w,"data-testid":"lg-toast-region",role:"status","aria-live":"polite","aria-relevant":"all",onFocus:I,onBlur:A,onKeyDown:function(n){un&&n.key===T.Escape&&Y()},className:p($e,Q(Q(Q(Q(Q({},Ge,q),Je({topToastHeight:en[ln],recentToastsLength:_.length}),q),Qe({totalStackHeight:on,bottomOffset:G}),q&&(z||W)),Ze,q&&un),nt,un&&!W))},n.createElement("div",{ref:j,"data-testid":"lg-toast-scroll-container",onMouseEnter:I,onMouseLeave:A,className:p(et,Q(Q({},tt(on),un),rt,un&&!W))},n.createElement(c,{enter:!0,exit:!0,component:null},X.reverse().map((function(e,t){var r=tn(e,2),o=r[0],a=r[1],i=a.onClose,s=a.className,l=nn(a,ct),c=P(o);return i=function(n){return function(e){return hn(n,e)}}(o),n.createElement(u,{onEntering:mn,onEntered:pn,onExiting:gn,onExited:fn,key:o,timeout:N.default},(function(e){return n.createElement(Se,Z({},l,{id:o,ref:c,onClose:i,index:t,isHovered:z||W,className:p(ot({state:e,theme:H,index:t}),Q(Q({},at({theme:H,index:t,topToastHeight:en[ln]}),!(z||W)),it({positionY:an(t,un)+G,height:en[o],theme:H}),z||W),s),description:l.description}))}))}))),n.createElement(u,{in:$&&!W,timeout:N.slower},(function(e){return n.createElement(Ke,{count:K.length,onClick:U,className:_e[e]})})))))},ft={pushToast:function(){return""},popToast:function(){},updateToast:function(){},getToast:function(){},getStack:function(){},clearStack:function(){}},pt=n.createContext(ft),mt=function(n){return n.Push="push",n.Pop="pop",n.Update="update",n.Clear="clear",n}({});function gt(n){return G({id:function(n){var e;do{e="toast-"+(1e4*Math.random()).toFixed(0).padStart(4,"0")}while(void 0!==n);return e}()},n)}var ht=["id"],vt=function(n,e){switch(e.type){case mt.Push:var t=n.stack,r=e.payload,o=r.id,a=nn(r,ht);return{stack:t.set(o,G(G({},Yn),a))};case mt.Pop:var i=n.stack,s=e.payload;return i.get(s)&&i.delete(s),{stack:i};case mt.Update:var l=n.stack,c=e.payload,u=c.id,d=c.props,f=l.get(u);return f&&l.set(u,G(G({},f),d)),{stack:l};case mt.Clear:var p=n.stack;return p.clear(),{stack:p}}},bt=["stack"],yt=function(t){var o=t.children,a=t.initialValue,s=t.portalClassName,l=function(n){var t=tn(i(vt,{stack:null!=n?n:new Map}),2),o=t[0].stack,a=t[1],s=e((function(n){var e=gt(n);return a({type:mt.Push,payload:e}),e.id}),[]),l=e((function(n){return o.get(n)}),[o]),c=e((function(n){var e=l(n);return a({type:mt.Pop,payload:n}),e}),[l]),u=e((function(n,e){var t={type:mt.Update,payload:{id:n,props:e}};return a(t),vt({stack:o},t).stack.get(n)}),[o]),d=e((function(){a({type:mt.Clear})}),[]);return r((function(){return{pushToast:s,popToast:c,updateToast:u,getToast:l,clearStack:d,stack:o}}),[s,c,u,o,l,d])}(a),c=l.stack,u=nn(l,bt),d=e((function(){return c}),[c]),f=r((function(){return G(G({},u),{},{getStack:d})}),[u,d]);return n.createElement(pt.Provider,{value:f},o,n.createElement(dt,{stack:c,portalClassName:s}))},xt=function(){var n=s(pt);return!K(n.getStack())||console.warn("`useToast` hook must be used within a `ToastProvider` context"),n};var kt=["open"],wt=function(n){var t=n.open,r=nn(n,kt);r=l(r,Yn);var i=xt(),s=i.pushToast,c=i.popToast,u=i.updateToast,d=o(null),f=function(n){var t=o(n.onClose);t.current=n.onClose;var r=e((function(){for(var n,e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return null===(n=t.current)||void 0===n?void 0:n.call.apply(n,[t].concat(r))}),[]),a=G(G({},n),{},{onClose:r}),i=o(null),s=i.current,l=null!=s&&X(a,s)?s:a;return i.current=l,l}(r);return a((function(){var n=d.current;t?null==n?d.current=s(G({isControlled:!0},f)):u(n,f):!t&&n&&(c(n),d.current=null)}),[t,c,s,u,f]),a((function(){return function(){null!=d.current&&c(d.current)}}),[c]),null};export{wt as Toast,yt as ToastProvider,Un as Variant,ut as toastPortalClassName,xt as useToast};
//# sourceMappingURL=index.js.map
